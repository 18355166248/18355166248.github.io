<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Swell</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut con" type="image/x-icon" href="/favicon.ico">
    <meta name="description" content="2021, 学习进步!">
    
    <link rel="preload" href="/assets/css/0.styles.e31f0171.css" as="style"><link rel="preload" href="/assets/js/app.73a5ecf6.js" as="script"><link rel="preload" href="/assets/js/2.590ae2eb.js" as="script"><link rel="preload" href="/assets/js/1.bccb620a.js" as="script"><link rel="preload" href="/assets/js/436.c728cef0.js" as="script"><link rel="prefetch" href="/assets/js/10.15f52ef6.js"><link rel="prefetch" href="/assets/js/100.61d0b64a.js"><link rel="prefetch" href="/assets/js/101.2acb61f2.js"><link rel="prefetch" href="/assets/js/102.cc751063.js"><link rel="prefetch" href="/assets/js/103.37b13de0.js"><link rel="prefetch" href="/assets/js/104.e261251b.js"><link rel="prefetch" href="/assets/js/105.0682bdef.js"><link rel="prefetch" href="/assets/js/106.af258742.js"><link rel="prefetch" href="/assets/js/107.103307e5.js"><link rel="prefetch" href="/assets/js/108.2042a201.js"><link rel="prefetch" href="/assets/js/109.0578731f.js"><link rel="prefetch" href="/assets/js/11.32a47492.js"><link rel="prefetch" href="/assets/js/110.d7a1a747.js"><link rel="prefetch" href="/assets/js/111.766a2999.js"><link rel="prefetch" href="/assets/js/112.d1c2833a.js"><link rel="prefetch" href="/assets/js/113.96bd50ed.js"><link rel="prefetch" href="/assets/js/114.11c4a3ba.js"><link rel="prefetch" href="/assets/js/115.00a93f85.js"><link rel="prefetch" href="/assets/js/116.fd649365.js"><link rel="prefetch" href="/assets/js/117.6d98debf.js"><link rel="prefetch" href="/assets/js/118.9bdee4c6.js"><link rel="prefetch" href="/assets/js/119.e5fcc0ca.js"><link rel="prefetch" href="/assets/js/12.a9377396.js"><link rel="prefetch" href="/assets/js/120.94a5f1eb.js"><link rel="prefetch" href="/assets/js/121.848c781c.js"><link rel="prefetch" href="/assets/js/122.c837c652.js"><link rel="prefetch" href="/assets/js/123.3db9a05d.js"><link rel="prefetch" href="/assets/js/124.1ae4b858.js"><link rel="prefetch" href="/assets/js/125.a79b8edb.js"><link rel="prefetch" href="/assets/js/126.5e12598c.js"><link rel="prefetch" href="/assets/js/127.57db96aa.js"><link rel="prefetch" href="/assets/js/128.428b8f6f.js"><link rel="prefetch" href="/assets/js/129.0b86e631.js"><link rel="prefetch" href="/assets/js/13.1357771b.js"><link rel="prefetch" href="/assets/js/130.75dfb8e2.js"><link rel="prefetch" href="/assets/js/131.67dd4855.js"><link rel="prefetch" href="/assets/js/132.b106df8c.js"><link rel="prefetch" href="/assets/js/133.c38efec5.js"><link rel="prefetch" href="/assets/js/134.1d49c265.js"><link rel="prefetch" href="/assets/js/135.09365786.js"><link rel="prefetch" href="/assets/js/136.9b1d494f.js"><link rel="prefetch" href="/assets/js/137.a355ea4b.js"><link rel="prefetch" href="/assets/js/138.e73bb572.js"><link rel="prefetch" href="/assets/js/139.3525cfb3.js"><link rel="prefetch" href="/assets/js/14.129948e8.js"><link rel="prefetch" href="/assets/js/140.2131c2c4.js"><link rel="prefetch" href="/assets/js/141.9ca5922a.js"><link rel="prefetch" href="/assets/js/142.cb9ed10a.js"><link rel="prefetch" href="/assets/js/143.04a6859e.js"><link rel="prefetch" href="/assets/js/144.72c11427.js"><link rel="prefetch" href="/assets/js/145.eece3ef3.js"><link rel="prefetch" href="/assets/js/146.caa6a0ec.js"><link rel="prefetch" href="/assets/js/147.e4ff2723.js"><link rel="prefetch" href="/assets/js/148.55f56cef.js"><link rel="prefetch" href="/assets/js/149.97a82a9e.js"><link rel="prefetch" href="/assets/js/15.60ba5750.js"><link rel="prefetch" href="/assets/js/150.7e3541b5.js"><link rel="prefetch" href="/assets/js/151.afb984a9.js"><link rel="prefetch" href="/assets/js/152.9e44b954.js"><link rel="prefetch" href="/assets/js/153.124289f6.js"><link rel="prefetch" href="/assets/js/154.6597518c.js"><link rel="prefetch" href="/assets/js/155.8b531821.js"><link rel="prefetch" href="/assets/js/156.75abab4a.js"><link rel="prefetch" href="/assets/js/157.3c64d55c.js"><link rel="prefetch" href="/assets/js/158.2561d095.js"><link rel="prefetch" href="/assets/js/159.314def34.js"><link rel="prefetch" href="/assets/js/16.434fa20b.js"><link rel="prefetch" href="/assets/js/160.c47e3bdc.js"><link rel="prefetch" href="/assets/js/161.2756adf0.js"><link rel="prefetch" href="/assets/js/162.d0702a97.js"><link rel="prefetch" href="/assets/js/163.15ec5879.js"><link rel="prefetch" href="/assets/js/164.be28b05d.js"><link rel="prefetch" href="/assets/js/165.ad18ab78.js"><link rel="prefetch" href="/assets/js/166.c7b2579a.js"><link rel="prefetch" href="/assets/js/167.9a1a27ae.js"><link rel="prefetch" href="/assets/js/168.a63db718.js"><link rel="prefetch" href="/assets/js/169.72d60f8a.js"><link rel="prefetch" href="/assets/js/17.3db09ca6.js"><link rel="prefetch" href="/assets/js/170.26911f2c.js"><link rel="prefetch" href="/assets/js/171.35b59af1.js"><link rel="prefetch" href="/assets/js/172.92e4aeaa.js"><link rel="prefetch" href="/assets/js/173.ee3d9ade.js"><link rel="prefetch" href="/assets/js/174.7cb0604e.js"><link rel="prefetch" href="/assets/js/175.58f66365.js"><link rel="prefetch" href="/assets/js/176.5c71c1eb.js"><link rel="prefetch" href="/assets/js/177.37f53d06.js"><link rel="prefetch" href="/assets/js/178.249b498a.js"><link rel="prefetch" href="/assets/js/179.c795c950.js"><link rel="prefetch" href="/assets/js/18.f9f8a7d5.js"><link rel="prefetch" href="/assets/js/180.7b0c1ea3.js"><link rel="prefetch" href="/assets/js/181.be0e946d.js"><link rel="prefetch" href="/assets/js/182.b435f95d.js"><link rel="prefetch" href="/assets/js/183.b91027d4.js"><link rel="prefetch" href="/assets/js/184.f1c8d5eb.js"><link rel="prefetch" href="/assets/js/185.238c1129.js"><link rel="prefetch" href="/assets/js/186.d5ff2a54.js"><link rel="prefetch" href="/assets/js/187.dba21a64.js"><link rel="prefetch" href="/assets/js/188.70530b62.js"><link rel="prefetch" href="/assets/js/189.0477f6c9.js"><link rel="prefetch" href="/assets/js/19.da0d0d64.js"><link rel="prefetch" href="/assets/js/190.011a7dc3.js"><link rel="prefetch" href="/assets/js/191.72cde41e.js"><link rel="prefetch" href="/assets/js/192.40336c25.js"><link rel="prefetch" href="/assets/js/193.0da143ab.js"><link rel="prefetch" href="/assets/js/194.0241ed0f.js"><link rel="prefetch" href="/assets/js/195.b750b3d2.js"><link rel="prefetch" href="/assets/js/196.ce5139eb.js"><link rel="prefetch" href="/assets/js/197.600c2192.js"><link rel="prefetch" href="/assets/js/198.ca857430.js"><link rel="prefetch" href="/assets/js/199.d35856a6.js"><link rel="prefetch" href="/assets/js/20.948940b4.js"><link rel="prefetch" href="/assets/js/200.2662b113.js"><link rel="prefetch" href="/assets/js/201.0f62685f.js"><link rel="prefetch" href="/assets/js/202.ec52b31d.js"><link rel="prefetch" href="/assets/js/203.76d276b6.js"><link rel="prefetch" href="/assets/js/204.24636359.js"><link rel="prefetch" href="/assets/js/205.376d0c2c.js"><link rel="prefetch" href="/assets/js/206.681e208a.js"><link rel="prefetch" href="/assets/js/207.29b7ecd7.js"><link rel="prefetch" href="/assets/js/208.f38558c4.js"><link rel="prefetch" href="/assets/js/209.947fab6b.js"><link rel="prefetch" href="/assets/js/21.ffab7a62.js"><link rel="prefetch" href="/assets/js/210.45adef84.js"><link rel="prefetch" href="/assets/js/211.97bbbb16.js"><link rel="prefetch" href="/assets/js/212.3f9d660e.js"><link rel="prefetch" href="/assets/js/213.935cd19f.js"><link rel="prefetch" href="/assets/js/214.bb38d432.js"><link rel="prefetch" href="/assets/js/215.f2fe281a.js"><link rel="prefetch" href="/assets/js/216.e296c9f9.js"><link rel="prefetch" href="/assets/js/217.8f6dbf39.js"><link rel="prefetch" href="/assets/js/218.045a0cc1.js"><link rel="prefetch" href="/assets/js/219.58df4a99.js"><link rel="prefetch" href="/assets/js/22.f0750ced.js"><link rel="prefetch" href="/assets/js/220.f68d303a.js"><link rel="prefetch" href="/assets/js/221.05da8f02.js"><link rel="prefetch" href="/assets/js/222.60099e9e.js"><link rel="prefetch" href="/assets/js/223.5825abcb.js"><link rel="prefetch" href="/assets/js/224.f4d99f78.js"><link rel="prefetch" href="/assets/js/225.60ede1ac.js"><link rel="prefetch" href="/assets/js/226.e7763dee.js"><link rel="prefetch" href="/assets/js/227.63c5ae52.js"><link rel="prefetch" href="/assets/js/228.9931d7cb.js"><link rel="prefetch" href="/assets/js/229.2897f6cc.js"><link rel="prefetch" href="/assets/js/23.283ccf93.js"><link rel="prefetch" href="/assets/js/230.c4a51166.js"><link rel="prefetch" href="/assets/js/231.6d53d108.js"><link rel="prefetch" href="/assets/js/232.b6c1a649.js"><link rel="prefetch" href="/assets/js/233.b6bb02d0.js"><link rel="prefetch" href="/assets/js/234.c355f3f3.js"><link rel="prefetch" href="/assets/js/235.075c0233.js"><link rel="prefetch" href="/assets/js/236.8f9ef9de.js"><link rel="prefetch" href="/assets/js/237.6b7cfc49.js"><link rel="prefetch" href="/assets/js/238.edfd425e.js"><link rel="prefetch" href="/assets/js/239.e2a85a98.js"><link rel="prefetch" href="/assets/js/24.549c92e1.js"><link rel="prefetch" href="/assets/js/240.f82824ab.js"><link rel="prefetch" href="/assets/js/241.41117afc.js"><link rel="prefetch" href="/assets/js/242.c2def09d.js"><link rel="prefetch" href="/assets/js/243.7e7c309d.js"><link rel="prefetch" href="/assets/js/244.b4836d63.js"><link rel="prefetch" href="/assets/js/245.e9b28214.js"><link rel="prefetch" href="/assets/js/246.edad5b50.js"><link rel="prefetch" href="/assets/js/247.9139b4e7.js"><link rel="prefetch" href="/assets/js/248.a41aedec.js"><link rel="prefetch" href="/assets/js/249.fd740137.js"><link rel="prefetch" href="/assets/js/25.f5416b6b.js"><link rel="prefetch" href="/assets/js/250.c6f68ffb.js"><link rel="prefetch" href="/assets/js/251.b0574d28.js"><link rel="prefetch" href="/assets/js/252.12320ad4.js"><link rel="prefetch" href="/assets/js/253.0a85a88b.js"><link rel="prefetch" href="/assets/js/254.8fd5a710.js"><link rel="prefetch" href="/assets/js/255.4f3061e8.js"><link rel="prefetch" href="/assets/js/256.6f3a49d3.js"><link rel="prefetch" href="/assets/js/257.5a61d2a2.js"><link rel="prefetch" href="/assets/js/258.2e3a86c4.js"><link rel="prefetch" href="/assets/js/259.deb76784.js"><link rel="prefetch" href="/assets/js/26.47adf9d4.js"><link rel="prefetch" href="/assets/js/260.77519cfe.js"><link rel="prefetch" href="/assets/js/261.25ba0f87.js"><link rel="prefetch" href="/assets/js/262.e92b5de5.js"><link rel="prefetch" href="/assets/js/263.031828ff.js"><link rel="prefetch" href="/assets/js/264.0179601d.js"><link rel="prefetch" href="/assets/js/265.277b1913.js"><link rel="prefetch" href="/assets/js/266.ceef02f4.js"><link rel="prefetch" href="/assets/js/267.e556946a.js"><link rel="prefetch" href="/assets/js/268.f1f1fe93.js"><link rel="prefetch" href="/assets/js/269.68cb4b59.js"><link rel="prefetch" href="/assets/js/27.fdf58993.js"><link rel="prefetch" href="/assets/js/270.922a1bee.js"><link rel="prefetch" href="/assets/js/271.bcefd25b.js"><link rel="prefetch" href="/assets/js/272.c06e3568.js"><link rel="prefetch" href="/assets/js/273.94b0334e.js"><link rel="prefetch" href="/assets/js/274.6a12df1b.js"><link rel="prefetch" href="/assets/js/275.75a2ab5b.js"><link rel="prefetch" href="/assets/js/276.966002fe.js"><link rel="prefetch" href="/assets/js/277.3f5d1117.js"><link rel="prefetch" href="/assets/js/278.1cd76f2f.js"><link rel="prefetch" href="/assets/js/279.c7124168.js"><link rel="prefetch" href="/assets/js/28.87aace24.js"><link rel="prefetch" href="/assets/js/280.252d2aa6.js"><link rel="prefetch" href="/assets/js/281.8fca868e.js"><link rel="prefetch" href="/assets/js/282.fcfd620c.js"><link rel="prefetch" href="/assets/js/283.3e0b94b7.js"><link rel="prefetch" href="/assets/js/284.523b96ff.js"><link rel="prefetch" href="/assets/js/285.85cf77f9.js"><link rel="prefetch" href="/assets/js/286.abff2675.js"><link rel="prefetch" href="/assets/js/287.d744429b.js"><link rel="prefetch" href="/assets/js/288.2f7aae1a.js"><link rel="prefetch" href="/assets/js/289.d37641c2.js"><link rel="prefetch" href="/assets/js/29.f624641d.js"><link rel="prefetch" href="/assets/js/290.c90625e0.js"><link rel="prefetch" href="/assets/js/291.6f078ea0.js"><link rel="prefetch" href="/assets/js/292.10db5141.js"><link rel="prefetch" href="/assets/js/293.c2b10f03.js"><link rel="prefetch" href="/assets/js/294.493f7a91.js"><link rel="prefetch" href="/assets/js/295.03545ba9.js"><link rel="prefetch" href="/assets/js/296.0f878bcd.js"><link rel="prefetch" href="/assets/js/297.9dfb1869.js"><link rel="prefetch" href="/assets/js/298.cea4af99.js"><link rel="prefetch" href="/assets/js/299.0fa93e26.js"><link rel="prefetch" href="/assets/js/3.d321bae9.js"><link rel="prefetch" href="/assets/js/30.a9b3d27a.js"><link rel="prefetch" href="/assets/js/300.c12dda56.js"><link rel="prefetch" href="/assets/js/301.5b465bca.js"><link rel="prefetch" href="/assets/js/302.56be3ec1.js"><link rel="prefetch" href="/assets/js/303.6163a9da.js"><link rel="prefetch" href="/assets/js/304.8d1fa21a.js"><link rel="prefetch" href="/assets/js/305.e3af5ad8.js"><link rel="prefetch" href="/assets/js/306.787f8b4f.js"><link rel="prefetch" href="/assets/js/307.7bb2044c.js"><link rel="prefetch" href="/assets/js/308.939fe0dc.js"><link rel="prefetch" href="/assets/js/309.105ade61.js"><link rel="prefetch" href="/assets/js/31.4f87f432.js"><link rel="prefetch" href="/assets/js/310.23d3283d.js"><link rel="prefetch" href="/assets/js/311.fb07ad70.js"><link rel="prefetch" href="/assets/js/312.a0c7fb17.js"><link rel="prefetch" href="/assets/js/313.3c7d78df.js"><link rel="prefetch" href="/assets/js/314.a640628b.js"><link rel="prefetch" href="/assets/js/315.9f58262d.js"><link rel="prefetch" href="/assets/js/316.0679c439.js"><link rel="prefetch" href="/assets/js/317.58cefee8.js"><link rel="prefetch" href="/assets/js/318.f89c86a9.js"><link rel="prefetch" href="/assets/js/319.5c9b58dd.js"><link rel="prefetch" href="/assets/js/32.2d66ef98.js"><link rel="prefetch" href="/assets/js/320.cb30281f.js"><link rel="prefetch" href="/assets/js/321.58711745.js"><link rel="prefetch" href="/assets/js/322.9fb45200.js"><link rel="prefetch" href="/assets/js/323.08f066c1.js"><link rel="prefetch" href="/assets/js/324.ab20ff92.js"><link rel="prefetch" href="/assets/js/325.4bbe8bcc.js"><link rel="prefetch" href="/assets/js/326.e8f257de.js"><link rel="prefetch" href="/assets/js/327.b7922a24.js"><link rel="prefetch" href="/assets/js/328.612faf69.js"><link rel="prefetch" href="/assets/js/329.18cb9234.js"><link rel="prefetch" href="/assets/js/33.262157a7.js"><link rel="prefetch" href="/assets/js/330.d810de8c.js"><link rel="prefetch" href="/assets/js/331.66f12117.js"><link rel="prefetch" href="/assets/js/332.16527475.js"><link rel="prefetch" href="/assets/js/333.b4a0d6e8.js"><link rel="prefetch" href="/assets/js/334.c4979f8e.js"><link rel="prefetch" href="/assets/js/335.1fff99de.js"><link rel="prefetch" href="/assets/js/336.c149bfa0.js"><link rel="prefetch" href="/assets/js/337.6dc650a0.js"><link rel="prefetch" href="/assets/js/338.84ae317b.js"><link rel="prefetch" href="/assets/js/339.fcc65273.js"><link rel="prefetch" href="/assets/js/34.9949ec5d.js"><link rel="prefetch" href="/assets/js/340.949a7827.js"><link rel="prefetch" href="/assets/js/341.cd7c5de6.js"><link rel="prefetch" href="/assets/js/342.9073f1c6.js"><link rel="prefetch" href="/assets/js/343.853dffc8.js"><link rel="prefetch" href="/assets/js/344.ee9817ad.js"><link rel="prefetch" href="/assets/js/345.fd1a3efe.js"><link rel="prefetch" href="/assets/js/346.10fa8918.js"><link rel="prefetch" href="/assets/js/347.e45c01e6.js"><link rel="prefetch" href="/assets/js/348.daef24fa.js"><link rel="prefetch" href="/assets/js/349.79f84f02.js"><link rel="prefetch" href="/assets/js/35.42dbe1ae.js"><link rel="prefetch" href="/assets/js/350.f5303241.js"><link rel="prefetch" href="/assets/js/351.44ebc7dd.js"><link rel="prefetch" href="/assets/js/352.a1433337.js"><link rel="prefetch" href="/assets/js/353.37c41c1c.js"><link rel="prefetch" href="/assets/js/354.b8bcaf81.js"><link rel="prefetch" href="/assets/js/355.3fdd463f.js"><link rel="prefetch" href="/assets/js/356.b263cbca.js"><link rel="prefetch" href="/assets/js/357.a6fde844.js"><link rel="prefetch" href="/assets/js/358.cffcdc1a.js"><link rel="prefetch" href="/assets/js/359.bf845a92.js"><link rel="prefetch" href="/assets/js/36.f54de322.js"><link rel="prefetch" href="/assets/js/360.6e89ae62.js"><link rel="prefetch" href="/assets/js/361.b51e86d2.js"><link rel="prefetch" href="/assets/js/362.71e4d67f.js"><link rel="prefetch" href="/assets/js/363.c96217a7.js"><link rel="prefetch" href="/assets/js/364.8b1960d8.js"><link rel="prefetch" href="/assets/js/365.243a5839.js"><link rel="prefetch" href="/assets/js/366.2ff73822.js"><link rel="prefetch" href="/assets/js/367.f6651e21.js"><link rel="prefetch" href="/assets/js/368.d7450f89.js"><link rel="prefetch" href="/assets/js/369.fd7af554.js"><link rel="prefetch" href="/assets/js/37.d257ac56.js"><link rel="prefetch" href="/assets/js/370.0bbbe839.js"><link rel="prefetch" href="/assets/js/371.9c073767.js"><link rel="prefetch" href="/assets/js/372.a4d4cd69.js"><link rel="prefetch" href="/assets/js/373.eb142bb9.js"><link rel="prefetch" href="/assets/js/374.34d1a792.js"><link rel="prefetch" href="/assets/js/375.ef1814ae.js"><link rel="prefetch" href="/assets/js/376.2e7e35dd.js"><link rel="prefetch" href="/assets/js/377.2bea8bea.js"><link rel="prefetch" href="/assets/js/378.e1bbe6f5.js"><link rel="prefetch" href="/assets/js/379.a693e336.js"><link rel="prefetch" href="/assets/js/38.c99f6657.js"><link rel="prefetch" href="/assets/js/380.018ee343.js"><link rel="prefetch" href="/assets/js/381.80d84aa4.js"><link rel="prefetch" href="/assets/js/382.1569da57.js"><link rel="prefetch" href="/assets/js/383.f7d4fc06.js"><link rel="prefetch" href="/assets/js/384.7f3e2055.js"><link rel="prefetch" href="/assets/js/385.6a25d774.js"><link rel="prefetch" href="/assets/js/386.fc9cb4b9.js"><link rel="prefetch" href="/assets/js/387.fc40d3d9.js"><link rel="prefetch" href="/assets/js/388.51191a8c.js"><link rel="prefetch" href="/assets/js/389.5210b974.js"><link rel="prefetch" href="/assets/js/39.c39c0252.js"><link rel="prefetch" href="/assets/js/390.ab328e43.js"><link rel="prefetch" href="/assets/js/391.46d950c7.js"><link rel="prefetch" href="/assets/js/392.b2213afe.js"><link rel="prefetch" href="/assets/js/393.246ac08c.js"><link rel="prefetch" href="/assets/js/394.dc519b93.js"><link rel="prefetch" href="/assets/js/395.d370b54e.js"><link rel="prefetch" href="/assets/js/396.21bf2546.js"><link rel="prefetch" href="/assets/js/397.b944e3dd.js"><link rel="prefetch" href="/assets/js/398.b53f1146.js"><link rel="prefetch" href="/assets/js/399.3e797024.js"><link rel="prefetch" href="/assets/js/4.952753dd.js"><link rel="prefetch" href="/assets/js/40.aeb3e8e9.js"><link rel="prefetch" href="/assets/js/400.4375d8bb.js"><link rel="prefetch" href="/assets/js/401.ef5bda6e.js"><link rel="prefetch" href="/assets/js/402.24339925.js"><link rel="prefetch" href="/assets/js/403.30020bfb.js"><link rel="prefetch" href="/assets/js/404.97cf7983.js"><link rel="prefetch" href="/assets/js/405.94cec870.js"><link rel="prefetch" href="/assets/js/406.d15dbab5.js"><link rel="prefetch" href="/assets/js/407.04787171.js"><link rel="prefetch" href="/assets/js/408.1a2e9af2.js"><link rel="prefetch" href="/assets/js/409.a5cc2024.js"><link rel="prefetch" href="/assets/js/41.2f2d275c.js"><link rel="prefetch" href="/assets/js/410.dbbef180.js"><link rel="prefetch" href="/assets/js/411.d762bcd5.js"><link rel="prefetch" href="/assets/js/412.54ae71e5.js"><link rel="prefetch" href="/assets/js/413.f3ce412a.js"><link rel="prefetch" href="/assets/js/414.004f8093.js"><link rel="prefetch" href="/assets/js/415.e23a63de.js"><link rel="prefetch" href="/assets/js/416.4cb1ec0c.js"><link rel="prefetch" href="/assets/js/417.cf435f4e.js"><link rel="prefetch" href="/assets/js/418.0bc0ac91.js"><link rel="prefetch" href="/assets/js/419.5540565a.js"><link rel="prefetch" href="/assets/js/42.d1a59707.js"><link rel="prefetch" href="/assets/js/420.83bca0e5.js"><link rel="prefetch" href="/assets/js/421.62f5048f.js"><link rel="prefetch" href="/assets/js/422.0051f244.js"><link rel="prefetch" href="/assets/js/423.302e5ec0.js"><link rel="prefetch" href="/assets/js/424.fe376e48.js"><link rel="prefetch" href="/assets/js/425.1eb95e2b.js"><link rel="prefetch" href="/assets/js/426.80f36ff2.js"><link rel="prefetch" href="/assets/js/427.4a0a2482.js"><link rel="prefetch" href="/assets/js/428.42f7db97.js"><link rel="prefetch" href="/assets/js/429.c65e4b4e.js"><link rel="prefetch" href="/assets/js/43.db6fab67.js"><link rel="prefetch" href="/assets/js/430.8589ad49.js"><link rel="prefetch" href="/assets/js/431.c4578f04.js"><link rel="prefetch" href="/assets/js/432.560e209c.js"><link rel="prefetch" href="/assets/js/433.985be6b0.js"><link rel="prefetch" href="/assets/js/434.e681afda.js"><link rel="prefetch" href="/assets/js/435.ad089b11.js"><link rel="prefetch" href="/assets/js/437.c562f870.js"><link rel="prefetch" href="/assets/js/438.ec965223.js"><link rel="prefetch" href="/assets/js/439.0fe4e944.js"><link rel="prefetch" href="/assets/js/44.09ac75e5.js"><link rel="prefetch" href="/assets/js/440.db944733.js"><link rel="prefetch" href="/assets/js/441.f5aa8d31.js"><link rel="prefetch" href="/assets/js/442.9761dd62.js"><link rel="prefetch" href="/assets/js/443.15c87d61.js"><link rel="prefetch" href="/assets/js/444.f39a19ae.js"><link rel="prefetch" href="/assets/js/445.f47183ad.js"><link rel="prefetch" href="/assets/js/446.b0c0e2fd.js"><link rel="prefetch" href="/assets/js/447.312d1c26.js"><link rel="prefetch" href="/assets/js/448.35ff7716.js"><link rel="prefetch" href="/assets/js/449.ad05d0b5.js"><link rel="prefetch" href="/assets/js/45.a3a5b2c5.js"><link rel="prefetch" href="/assets/js/450.ac24ea07.js"><link rel="prefetch" href="/assets/js/451.0c28ec36.js"><link rel="prefetch" href="/assets/js/452.1d4dc3cf.js"><link rel="prefetch" href="/assets/js/453.0de4724f.js"><link rel="prefetch" href="/assets/js/454.e45a4fd7.js"><link rel="prefetch" href="/assets/js/455.34a99165.js"><link rel="prefetch" href="/assets/js/456.2888615b.js"><link rel="prefetch" href="/assets/js/457.de1dd8e6.js"><link rel="prefetch" href="/assets/js/458.9f78503b.js"><link rel="prefetch" href="/assets/js/459.6ee6edc5.js"><link rel="prefetch" href="/assets/js/46.27102d42.js"><link rel="prefetch" href="/assets/js/460.4591a610.js"><link rel="prefetch" href="/assets/js/461.7d650e21.js"><link rel="prefetch" href="/assets/js/462.721db687.js"><link rel="prefetch" href="/assets/js/463.cb10e827.js"><link rel="prefetch" href="/assets/js/464.80f26301.js"><link rel="prefetch" href="/assets/js/465.c4a089d8.js"><link rel="prefetch" href="/assets/js/466.56b33a0f.js"><link rel="prefetch" href="/assets/js/467.af44f17d.js"><link rel="prefetch" href="/assets/js/468.b30f9487.js"><link rel="prefetch" href="/assets/js/469.543368f0.js"><link rel="prefetch" href="/assets/js/47.20b472c8.js"><link rel="prefetch" href="/assets/js/470.bd63a88e.js"><link rel="prefetch" href="/assets/js/471.9046c822.js"><link rel="prefetch" href="/assets/js/472.e76cf70c.js"><link rel="prefetch" href="/assets/js/473.70e10eb1.js"><link rel="prefetch" href="/assets/js/474.366ca9a6.js"><link rel="prefetch" href="/assets/js/475.473d542d.js"><link rel="prefetch" href="/assets/js/476.044b3917.js"><link rel="prefetch" href="/assets/js/477.0a850fed.js"><link rel="prefetch" href="/assets/js/478.93a186ed.js"><link rel="prefetch" href="/assets/js/479.ae0d7150.js"><link rel="prefetch" href="/assets/js/48.07ae4944.js"><link rel="prefetch" href="/assets/js/480.fca7692f.js"><link rel="prefetch" href="/assets/js/481.e19a44cb.js"><link rel="prefetch" href="/assets/js/482.ff4e7770.js"><link rel="prefetch" href="/assets/js/483.0c578313.js"><link rel="prefetch" href="/assets/js/484.1c5e8226.js"><link rel="prefetch" href="/assets/js/485.0ccfe11f.js"><link rel="prefetch" href="/assets/js/486.a63fd360.js"><link rel="prefetch" href="/assets/js/487.dede7361.js"><link rel="prefetch" href="/assets/js/488.03a6015d.js"><link rel="prefetch" href="/assets/js/489.793d83a8.js"><link rel="prefetch" href="/assets/js/49.9ff049f0.js"><link rel="prefetch" href="/assets/js/5.83a3ae03.js"><link rel="prefetch" href="/assets/js/50.8b04e8ce.js"><link rel="prefetch" href="/assets/js/51.3b944dd7.js"><link rel="prefetch" href="/assets/js/52.5880437c.js"><link rel="prefetch" href="/assets/js/53.49708fd4.js"><link rel="prefetch" href="/assets/js/54.d9d38f4a.js"><link rel="prefetch" href="/assets/js/55.45398666.js"><link rel="prefetch" href="/assets/js/56.62aa6a24.js"><link rel="prefetch" href="/assets/js/57.54197e24.js"><link rel="prefetch" href="/assets/js/58.e9807d81.js"><link rel="prefetch" href="/assets/js/59.987e0900.js"><link rel="prefetch" href="/assets/js/6.3360b31d.js"><link rel="prefetch" href="/assets/js/60.78d6f828.js"><link rel="prefetch" href="/assets/js/61.4b8596e3.js"><link rel="prefetch" href="/assets/js/62.c778d9df.js"><link rel="prefetch" href="/assets/js/63.ed842070.js"><link rel="prefetch" href="/assets/js/64.97f4283c.js"><link rel="prefetch" href="/assets/js/65.17b7afc7.js"><link rel="prefetch" href="/assets/js/66.192eaeb7.js"><link rel="prefetch" href="/assets/js/67.4006440a.js"><link rel="prefetch" href="/assets/js/68.4ddc1758.js"><link rel="prefetch" href="/assets/js/69.83787533.js"><link rel="prefetch" href="/assets/js/7.7718c6cb.js"><link rel="prefetch" href="/assets/js/70.3fa97a66.js"><link rel="prefetch" href="/assets/js/71.6175bdc1.js"><link rel="prefetch" href="/assets/js/72.a830c52e.js"><link rel="prefetch" href="/assets/js/73.374b6f7b.js"><link rel="prefetch" href="/assets/js/74.84391a89.js"><link rel="prefetch" href="/assets/js/75.80da576a.js"><link rel="prefetch" href="/assets/js/76.f4d7aba3.js"><link rel="prefetch" href="/assets/js/77.273a23c1.js"><link rel="prefetch" href="/assets/js/78.77ccfc62.js"><link rel="prefetch" href="/assets/js/79.a630b51b.js"><link rel="prefetch" href="/assets/js/80.89987a90.js"><link rel="prefetch" href="/assets/js/81.36429fca.js"><link rel="prefetch" href="/assets/js/82.229eba74.js"><link rel="prefetch" href="/assets/js/83.61046aa4.js"><link rel="prefetch" href="/assets/js/84.9dc0748b.js"><link rel="prefetch" href="/assets/js/85.a68cf375.js"><link rel="prefetch" href="/assets/js/86.83bd1812.js"><link rel="prefetch" href="/assets/js/87.8717162b.js"><link rel="prefetch" href="/assets/js/88.a584da3f.js"><link rel="prefetch" href="/assets/js/89.237c4fa9.js"><link rel="prefetch" href="/assets/js/90.9edcc6e0.js"><link rel="prefetch" href="/assets/js/91.56ac1f6e.js"><link rel="prefetch" href="/assets/js/92.5ab8b643.js"><link rel="prefetch" href="/assets/js/93.6a041412.js"><link rel="prefetch" href="/assets/js/94.9965cb67.js"><link rel="prefetch" href="/assets/js/95.24318fa3.js"><link rel="prefetch" href="/assets/js/96.b0ba8371.js"><link rel="prefetch" href="/assets/js/97.1332aa21.js"><link rel="prefetch" href="/assets/js/98.36f085f4.js"><link rel="prefetch" href="/assets/js/99.0fbd1a6b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.70bf0358.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e31f0171.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Swell</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/TypeScript/" class="nav-link router-link-active">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/ReactSourceCode/" class="nav-link">
  React源码
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Regex/" class="nav-link">
  正则表达式
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Eslint/" class="nav-link">
  Eslint
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Component/" class="nav-link">
  组件封装
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Performance/" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Utils/" class="nav-link">
  常用工具
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CaseQuestions/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Test/" class="nav-link">
  单元测试
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Monitor/" class="nav-link">
  前端监控
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Babel/" class="nav-link">
  Babel
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/MicroFrontEnd/" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/LowCode/" class="nav-link">
  低代码
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="AI" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/AI/Code/" class="nav-link">
  代码
</a></li><li class="dropdown-item"><!----> <a href="/notes/AI/Chat/" class="nav-link">
  聊天
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="转载文章" class="dropdown-title"><span class="title">转载文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="转载文章" class="mobile-dropdown-title"><span class="title">转载文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Transshipment/FrontEnd/" class="nav-link">
  前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务" class="dropdown-title"><span class="title">业务</span> <span class="arrow down"></span></button> <button type="button" aria-label="业务" class="mobile-dropdown-title"><span class="title">业务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Business/XIXIMA/" class="nav-link">
  XIXIMA
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow down"></span></button> <button type="button" aria-label="代码管理" class="mobile-dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/NPM/" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Lerna/" class="nav-link">
  Lerna
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/GitHub/" class="nav-link">
  GitHub
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Tools/Jenkins/" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Vscode/" class="nav-link">
  VsCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Editor/" class="nav-link">
  Editor
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCode/" class="nav-link">
  LeetCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCodeClass/" class="nav-link">
  分类
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Databases/MySql/" class="nav-link">
  MySql
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/18355166248" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/TypeScript/" class="nav-link router-link-active">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/ReactSourceCode/" class="nav-link">
  React源码
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Regex/" class="nav-link">
  正则表达式
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Eslint/" class="nav-link">
  Eslint
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Component/" class="nav-link">
  组件封装
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Performance/" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Utils/" class="nav-link">
  常用工具
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CaseQuestions/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Test/" class="nav-link">
  单元测试
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Monitor/" class="nav-link">
  前端监控
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Babel/" class="nav-link">
  Babel
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/MicroFrontEnd/" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/LowCode/" class="nav-link">
  低代码
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="AI" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/AI/Code/" class="nav-link">
  代码
</a></li><li class="dropdown-item"><!----> <a href="/notes/AI/Chat/" class="nav-link">
  聊天
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="转载文章" class="dropdown-title"><span class="title">转载文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="转载文章" class="mobile-dropdown-title"><span class="title">转载文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Transshipment/FrontEnd/" class="nav-link">
  前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务" class="dropdown-title"><span class="title">业务</span> <span class="arrow down"></span></button> <button type="button" aria-label="业务" class="mobile-dropdown-title"><span class="title">业务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Business/XIXIMA/" class="nav-link">
  XIXIMA
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow down"></span></button> <button type="button" aria-label="代码管理" class="mobile-dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/NPM/" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Lerna/" class="nav-link">
  Lerna
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/GitHub/" class="nav-link">
  GitHub
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Tools/Jenkins/" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Vscode/" class="nav-link">
  VsCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Editor/" class="nav-link">
  Editor
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCode/" class="nav-link">
  LeetCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCodeClass/" class="nav-link">
  分类
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Databases/MySql/" class="nav-link">
  MySql
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/18355166248" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/notes/ForentEnd/TypeScript/" aria-current="page" class="sidebar-link">TS文档</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html#为什么说-typescript-可能超越-javascript" class="sidebar-link">为什么说 TypeScript 可能超越 JavaScript？</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html#如何系统学习-typescript" class="sidebar-link">如何系统学习 TypeScript？</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html#这门课程是如何设计的" class="sidebar-link">这门课程是如何设计的？</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html#写在最后" class="sidebar-link">写在最后</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/1. 开篇：用正确的方式学习 TypeScript.html#课程中的代码" class="sidebar-link">课程中的代码</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html#vs-code-配置与插件" class="sidebar-link">VS Code 配置与插件</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html#playground-懒人福音" class="sidebar-link">Playground：懒人福音</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html#ts-文件的快速执行-ts-node-与-ts-node-dev" class="sidebar-link">TS 文件的快速执行：ts-node 与 ts-node-dev</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html#更方便的类型兼容性检查" class="sidebar-link">更方便的类型兼容性检查</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/2. 工欲善其事：打造最舒适的 TypeScript 开发环境.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html#原始类型的类型标注" class="sidebar-link">原始类型的类型标注</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html#数组的类型标注" class="sidebar-link">数组的类型标注</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html#对象的类型标注" class="sidebar-link">对象的类型标注</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/3. 进入类型的世界：理解原始类型与对象类型.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html#字面量类型与联合类型" class="sidebar-link">字面量类型与联合类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html#字面量类型" class="sidebar-link">字面量类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html#枚举" class="sidebar-link">枚举</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/4. 掌握字面量类型与枚举，让你的类型再精确一些.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/5. 函数与 Class 中的类型：详解函数重载与面向对象.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/5. 函数与 Class 中的类型：详解函数重载与面向对象.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/5. 函数与 Class 中的类型：详解函数重载与面向对象.html#函数" class="sidebar-link">函数</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/5. 函数与 Class 中的类型：详解函数重载与面向对象.html#class" class="sidebar-link">Class</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/5. 函数与 Class 中的类型：详解函数重载与面向对象.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/5. 函数与 Class 中的类型：详解函数重载与面向对象.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/6. 探秘内置类型：any、unknown、never 与类型断言.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/6. 探秘内置类型：any、unknown、never 与类型断言.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/6. 探秘内置类型：any、unknown、never 与类型断言.html#内置类型-any-、unknown-与-never" class="sidebar-link">内置类型：any 、unknown 与 never</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/6. 探秘内置类型：any、unknown、never 与类型断言.html#类型断言-警告编译器不准报错" class="sidebar-link">类型断言：警告编译器不准报错</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/6. 探秘内置类型：any、unknown、never 与类型断言.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/6. 探秘内置类型：any、unknown、never 与类型断言.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html#类型别名" class="sidebar-link">类型别名</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html#联合类型与交叉类型" class="sidebar-link">联合类型与交叉类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html#索引类型" class="sidebar-link">索引类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html#映射类型-类型编程的第一步" class="sidebar-link">映射类型：类型编程的第一步</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/7. 类型编程好帮手：TypeScript 类型工具（上）.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/8.类型编程好帮手：TypeScript 类型工具（下）.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/8.类型编程好帮手：TypeScript 类型工具（下）.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/8.类型编程好帮手：TypeScript 类型工具（下）.html#类型查询操作符-熟悉又陌生的-typeof" class="sidebar-link">类型查询操作符：熟悉又陌生的 typeof</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/8.类型编程好帮手：TypeScript 类型工具（下）.html#类型守卫" class="sidebar-link">类型守卫</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/8.类型编程好帮手：TypeScript 类型工具（下）.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/8.类型编程好帮手：TypeScript 类型工具（下）.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html#类型别名中的泛型" class="sidebar-link">类型别名中的泛型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html#对象类型中的泛型" class="sidebar-link">对象类型中的泛型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html#函数中的泛型" class="sidebar-link">函数中的泛型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html#class-中的泛型" class="sidebar-link">Class 中的泛型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/9.类型编程基石：TypeScript 中无处不在的泛型.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html#结构化类型系统" class="sidebar-link">结构化类型系统</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html#标称类型系统" class="sidebar-link">标称类型系统</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html#在-typescript-中模拟标称类型系统" class="sidebar-link">在 TypeScript 中模拟标称类型系统</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/10.结构化类型系统：类型兼容性判断的幕后.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#判断类型兼容性的方式" class="sidebar-link">判断类型兼容性的方式</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#从原始类型开始" class="sidebar-link">从原始类型开始</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#向上探索-直到穹顶之上" class="sidebar-link">向上探索，直到穹顶之上</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#向下探索-直到万物虚无" class="sidebar-link">向下探索，直到万物虚无</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#类型层级链" class="sidebar-link">类型层级链</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#其他比较场景" class="sidebar-link">其他比较场景</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/11.类型系统层级：从 Top Type 到 Bottom Type.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html#条件类型基础" class="sidebar-link">条件类型基础</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html#infer-关键字" class="sidebar-link">infer 关键字</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html#分布式条件类型" class="sidebar-link">分布式条件类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/12.类型里的逻辑运算：条件类型与 infer.html#扩展阅读-isany-与-isunknown" class="sidebar-link">扩展阅读：IsAny 与 IsUnknown</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#工具类型的分类" class="sidebar-link">工具类型的分类</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#属性修饰工具类型" class="sidebar-link">属性修饰工具类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#结构工具类型" class="sidebar-link">结构工具类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#集合工具类型" class="sidebar-link">集合工具类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#模式匹配工具类型" class="sidebar-link">模式匹配工具类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/13.内置工具类型基础：别再妖魔化工具类型了！.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/14.反方向类型推导：用好上下文相关类型.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/14.反方向类型推导：用好上下文相关类型.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/14.反方向类型推导：用好上下文相关类型.html#无处不在的上下文类型" class="sidebar-link">无处不在的上下文类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/14.反方向类型推导：用好上下文相关类型.html#void-返回值类型下的特殊情况" class="sidebar-link">void 返回值类型下的特殊情况</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/14.反方向类型推导：用好上下文相关类型.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/14.反方向类型推导：用好上下文相关类型.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html#如何比较函数的签名类型" class="sidebar-link">如何比较函数的签名类型？</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html#协变与逆变" class="sidebar-link">协变与逆变</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html#tsconfig-中的-strictfunctiontypes" class="sidebar-link">TSConfig 中的 StrictFunctionTypes</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/15.数类型：协变与逆变的比较.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/16.了解类型编程与类型体操的意义，找到平衡点.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/16.了解类型编程与类型体操的意义，找到平衡点.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/16.了解类型编程与类型体操的意义，找到平衡点.html#从类型编程到类型体操" class="sidebar-link">从类型编程到类型体操</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/16.了解类型编程与类型体操的意义，找到平衡点.html#type-challenges" class="sidebar-link">Type Challenges</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html#属性修饰进阶" class="sidebar-link">属性修饰进阶</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html#结构工具类型进阶" class="sidebar-link">结构工具类型进阶</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html#集合工具类型进阶" class="sidebar-link">集合工具类型进阶</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html#模式匹配工具类型进阶" class="sidebar-link">模式匹配工具类型进阶</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/17.内置工具类型进阶：类型编程进阶.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html#模板字符串类型的基础使用" class="sidebar-link">模板字符串类型的基础使用</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html#结合索引类型与映射类型" class="sidebar-link">结合索引类型与映射类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html#专用工具类型" class="sidebar-link">专用工具类型</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html#模板字符串类型与模式匹配" class="sidebar-link">模板字符串类型与模式匹配</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/18.基础类型新成员：模板字符串类型入门.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/19.类型编程新范式：模板字符串工具类型进阶.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/19.类型编程新范式：模板字符串工具类型进阶.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/19.类型编程新范式：模板字符串工具类型进阶.html#从最简单的模式匹配说起-trim、includes-等" class="sidebar-link">从最简单的模式匹配说起：Trim、Includes 等</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/19.类型编程新范式：模板字符串工具类型进阶.html#结构转换-replace、split-与-join" class="sidebar-link">结构转换：Replace、Split 与 Join</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/19.类型编程新范式：模板字符串工具类型进阶.html#最后一步-case-转换" class="sidebar-link">最后一步：Case 转换</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/19.类型编程新范式：模板字符串工具类型进阶.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#类型检查指令" class="sidebar-link">类型检查指令</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#类型声明" class="sidebar-link">类型声明</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#让类型定义全面覆盖你的项目" class="sidebar-link">让类型定义全面覆盖你的项目</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#三斜线指令" class="sidebar-link">三斜线指令</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#命名空间" class="sidebar-link">命名空间</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#仅类型导入" class="sidebar-link">仅类型导入</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/20.工程层面的类型能力：类型声明、类型指令与命名空间.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#项目初始化" class="sidebar-link">项目初始化</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#项目配置" class="sidebar-link">项目配置</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#组件声明" class="sidebar-link">组件声明</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#泛型坑位" class="sidebar-link">泛型坑位</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#内置类型定义" class="sidebar-link">内置类型定义</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#其他工程实践" class="sidebar-link">其他工程实践</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍.html#基本的-eslint-配置" class="sidebar-link">基本的 ESLint 配置</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍.html#配置-prettier-与-git-hooks" class="sidebar-link">配置 Prettier 与 Git Hooks</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍.html#typescript-下的-eslint-规则集推荐" class="sidebar-link">TypeScript 下的 ESLint 规则集推荐</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html#开发阶段" class="sidebar-link">开发阶段</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html#类型相关" class="sidebar-link">类型相关</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html#校验阶段" class="sidebar-link">校验阶段</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html#构建阶段" class="sidebar-link">构建阶段</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/23.全链路 TypeScript 工具库，找到适合你的工具.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/24.说说 TypeScript 和 ECMAScript 之间那些事儿.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/24.说说 TypeScript 和 ECMAScript 之间那些事儿.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/24.说说 TypeScript 和 ECMAScript 之间那些事儿.html#ecmascript-与-tc39" class="sidebar-link">ECMAScript 与 TC39</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/24.说说 TypeScript 和 ECMAScript 之间那些事儿.html#typescript-中的-ecmascript-语法" class="sidebar-link">TypeScript 中的 ECMAScript 语法</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/24.说说 TypeScript 和 ECMAScript 之间那些事儿.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/24.说说 TypeScript 和 ECMAScript 之间那些事儿.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html#装饰器大起底" class="sidebar-link">装饰器大起底</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html#反射-reflect" class="sidebar-link">反射 Reflect</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html#反射元数据-reflect-metadata" class="sidebar-link">反射元数据 Reflect Metadata</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/26.控制反转与依赖注入：基于装饰器的依赖注入实现.html" class="active sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/26.控制反转与依赖注入：基于装饰器的依赖注入实现.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/26.控制反转与依赖注入：基于装饰器的依赖注入实现.html#控制反转与依赖注入" class="sidebar-link">控制反转与依赖注入</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/26.控制反转与依赖注入：基于装饰器的依赖注入实现.html#实现一个简易-ioc-容器" class="sidebar-link">实现一个简易 IoC 容器</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/26.控制反转与依赖注入：基于装饰器的依赖注入实现.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/26.控制反转与依赖注入：基于装饰器的依赖注入实现.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/27.TSConfig 全解（上）：构建相关配置.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/27.TSConfig 全解（上）：构建相关配置.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/27.TSConfig 全解（上）：构建相关配置.html#构建相关" class="sidebar-link">构建相关</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/27.TSConfig 全解（上）：构建相关配置.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/28.TSConfig 全解（下）：检查相关、工程相关配置.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/28.TSConfig 全解（下）：检查相关、工程相关配置.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/28.TSConfig 全解（下）：检查相关、工程相关配置.html#检查相关" class="sidebar-link">检查相关</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/28.TSConfig 全解（下）：检查相关、工程相关配置.html#工程相关" class="sidebar-link">工程相关</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/28.TSConfig 全解（下）：检查相关、工程相关配置.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html#heroku-环境配置" class="sidebar-link">Heroku 环境配置</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html#nestjs-基础" class="sidebar-link">NestJS 基础</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html#prisma-基础" class="sidebar-link">Prisma 基础</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html#总结与预告" class="sidebar-link">总结与预告</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/29.基于 Prisma + NestJs 的 Node API ：前置知识储备.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html#heroku-初体验" class="sidebar-link">Heroku 初体验</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html#连接到-heroku-数据库" class="sidebar-link">连接到 Heroku 数据库</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html#初次部署" class="sidebar-link">初次部署</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html#api-开发" class="sidebar-link">API 开发</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署.html#总结与预告" class="sidebar-link">总结与预告</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html" class="sidebar-link">前置知识：Babel 的基本工作流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html#前置知识-babel-的基本工作流程" class="sidebar-link">前置知识：Babel 的基本工作流程</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html#使用-typescript-compiler-api" class="sidebar-link">使用 TypeScript Compiler API</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html#使用-ts-morph" class="sidebar-link">使用 ts-morph</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html#ast-checker-与-codemod" class="sidebar-link">AST Checker 与 CodeMod</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/31.玩转 TypeScript AST：AST Checker 与 CodeMod.html#扩展阅读" class="sidebar-link">扩展阅读</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/32.感谢相伴：是结束，也是开始.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/32.感谢相伴：是结束，也是开始.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/32.感谢相伴：是结束，也是开始.html#是结束" class="sidebar-link">是结束</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/32.感谢相伴：是结束，也是开始.html#也是开始" class="sidebar-link">也是开始</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/32.感谢相伴：是结束，也是开始.html#致谢" class="sidebar-link">致谢</a></li></ul></li><li><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html" class="sidebar-link">/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html#interface-与-type-异同点" class="sidebar-link">interface 与 type 异同点</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html#类型兼容性比较" class="sidebar-link">类型兼容性比较</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html#any、unknown-与-never" class="sidebar-link">any、unknown 与 never</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html#工具类型实现" class="sidebar-link">工具类型实现</a></li><li class="sidebar-sub-header"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/33.漫谈篇：面试中的 TypeScript.html#总结" class="sidebar-link">总结</a></li></ul></li></ul></section></li><li><a href="/notes/ForentEnd/TypeScript/dataTypes.html" class="sidebar-link">原始数据类型</a></li><li><a href="/notes/ForentEnd/TypeScript/declare.html" class="sidebar-link">Ts 声明文件</a></li><li><a href="/notes/ForentEnd/TypeScript/function.html" class="sidebar-link">函数</a></li><li><a href="/notes/ForentEnd/TypeScript/interface.html" class="sidebar-link">接口</a></li><li><a href="/notes/ForentEnd/TypeScript/top.html" class="sidebar-link">TS 进阶学习</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>上一节学习了装饰器与反射元数据的基本使用后，这一节我们将在其基础上来了解<strong>控制反转</strong>、<strong>依赖注入</strong>等概念，我们会使用装饰器配合反射元数据实现这一设计模式，以及实现基于装饰器的路由体系与一个简单的控制反转容器。</p> <blockquote><p>本节代码见：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Flinbudu599%2FTypeScript-Tiny-Book%2Ftree%2Fmain%2Fpackages%2F21-decorators" target="_blank" rel="noopener noreferrer">Decorators<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="控制反转与依赖注入"><a href="#控制反转与依赖注入" class="header-anchor">#</a> 控制反转与依赖注入</h2> <p>控制反转即 <strong>Inversion of Control</strong>，它是面向对象编程中的一种设计模式，可以用来很好地解耦代码。</p> <blockquote><p>由于控制反转出现的时间较晚，因而没有被包括在四人组的设计模式一书当中，但它仍然是一种设计模式。</p></blockquote> <p>假设我们存在多个具有依赖关系的类，可能会想当然这么写：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">A</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./modA'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">B</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./modB'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">A</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">B</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>现在一共只有三个类，倒还没问题，如果随着开发这些类的数量与依赖关系复杂度暴涨，C 依赖 A B，D 依赖 A C，F 依赖 B C D...，再加上每个类需要实例化的参数可能又有所不同，此时再去手动维护这些依赖关系与实例化过程就是灾难了。</p> <p>而控制反转模式则能够很好地解决这一问题，它引入了一个容器的概念，内部自动地维护了这些类的依赖关系，当我们需要一个类的时候，它会帮我们把这个类内部依赖的实例都填充好，我们直接用就行：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">F</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>d <span class="token operator">=</span> Container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">D</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>此时，我们的实例 D 已经完成了对 A、C 的依赖填充，C 也完成了 A、B 的依赖填充，也就是说所有复杂的依赖关系都被处理完毕了。</p> <p>这一模式就叫做<strong>控制反转</strong>。我们此前手动维护关系的模式则成为<strong>控制正转</strong>。举个例子，当我们想要处对象时，会上 Soul 这样的交友平台一个一个找，择偶条件是由我自己决定的，这就叫<strong>控制正转</strong>。现在我觉得这样太麻烦了，直接把自己的介绍、择偶条件上传到世纪佳缘，如果有人认为我不错，就会主动向我发起聊天，而这就是<strong>控制反转</strong>。</p> <p>控制反转的实现方式主要有两种，<strong>依赖查找</strong>与<strong>依赖注入</strong>。它们的本质其实均是<strong>将依赖关系的维护与创建独立出来</strong>。</p> <p>其中依赖查找在 JavaScript 中并不多见，它其实就是将实例化的过程放到了另外一个新的 Factory 方法中：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Factory</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">produce</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">F</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>d <span class="token operator">=</span> Factory<span class="token punctuation">.</span><span class="token function">produce</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在这里，我们的 Factory 类会按照传入的 key 去查找目标对象，然后再进行实例化与赋值过程。而依赖注入的代码则是这样的：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">F</span></span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  d<span class="token operator">:</span> <span class="token constant">D</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可以看到这里我们不需要手动进行赋值，只需要声明这个属性，然后使用装饰器标明它需要被注入一个值即可。</p> <p>这里的 Provide 即标明这个类需要被注册到容器中，如果别的地方需要这个类 F 时，其内部的 d 属性需要被注入一个 D 的实例，而 D 的实例又需要 A、C 的实例等等。这一系列的过程是完全交给容器的，我们需要做的就只是用装饰器简单标明下依赖关系即可。</p> <p>很明显，相比于依赖查找，依赖注入使用起来更加简洁，几乎不需要额外的业务代码，即不需要一个额外的 Factory 方法去维护实例化逻辑，但其依赖逻辑要更加黑盒。</p> <p>而装饰器如何实现依赖注入，我想其实你也能 get 到，不就是我们上面所说的元数据吗？比如在属性中通过 Inject 装饰器注册一份元数据，告诉容器这个类的哪些属性需要被注入，然后容器会在内部存储的类里面对应地进行查找。</p> <p>在部分前端框架中同样大量使用了基于装饰器的依赖注入体系，如 Angular、Nest、MidwayJS 等，目前来看在 NodeJs 框架中的使用要更为常见。如 Nest 与 Midway 中基于装饰器实现了路由、生命周期、模块、中间件与拦截器等等功能，举例来说，基于装饰器的路由可能是这么写的：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">userList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">'/add'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这么个路由声明意味着，<code>GET /user/list</code> 时会调用 userList 方法，而 <code>POST /user/add</code> 时则会调用 addUser 方法。</p> <p>学习了依赖注入之后，其实我们也可以来自己实现一个装饰器路由体系！</p> <h3 id="基于依赖注入的路由实现"><a href="#基于依赖注入的路由实现" class="header-anchor">#</a> 基于依赖注入的路由实现</h3> <blockquote><p>本节的代码是我最初在深入浅出 TypeScript 一书中学习到的内容，个人认为非常适合用于加深对依赖注入的理解，因此在其基础上进一步完善后，作为本节的实例代码。</p></blockquote> <p>我们的最终目的就是实现上面基于装饰器的路由能力，以及启动一个 Node Server 来完成对这个路由的承接。</p> <p>分析一下我们需要哪些能力？最重要的就是把每个方法对应的请求路径、请求方法和具体实现绑定起来，也就是在 <code>GET /user/list</code> 时，我们需要调用 <code>userList</code> 方法，并将返回值作为响应。那么，在方法的装饰器 <code>GET</code> <code>POST</code> 上，我们就可以将请求方法、请求路径、方法名、方法实现等信息注册为元数据，然后通过一个统一的提取手段来将它们组装起来。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">enum</span> <span class="token constant">METADATA_KEY</span> <span class="token punctuation">{</span>
  <span class="token constant">METHOD</span> <span class="token operator">=</span> <span class="token string">'ioc:method'</span><span class="token punctuation">,</span>
  <span class="token constant">PATH</span> <span class="token operator">=</span> <span class="token string">'ioc:path'</span><span class="token punctuation">,</span>
  <span class="token constant">MIDDLEWARE</span> <span class="token operator">=</span> <span class="token string">'ioc:middleware'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">enum</span> <span class="token constant">REQUEST_METHOD</span> <span class="token punctuation">{</span>
  <span class="token constant">GET</span> <span class="token operator">=</span> <span class="token string">'ioc:get'</span><span class="token punctuation">,</span>
  <span class="token constant">POST</span> <span class="token operator">=</span> <span class="token string">'ioc:post'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">methodDecoratorFactory</span> <span class="token operator">=</span> <span class="token punctuation">(</span>method<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> MethodDecorator <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>_target<span class="token punctuation">,</span> _key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 在方法实现上注册 ioc:method - 请求方法 的元数据</span>
      Reflect<span class="token punctuation">.</span><span class="token function">defineMetadata</span><span class="token punctuation">(</span><span class="token constant">METADATA_KEY</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> method<span class="token punctuation">,</span> descriptor<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 在方法实现上注册 ioc:path - 请求路径 的元数据</span>
      Reflect<span class="token punctuation">.</span><span class="token function">defineMetadata</span><span class="token punctuation">(</span><span class="token constant">METADATA_KEY</span><span class="token punctuation">.</span><span class="token constant">PATH</span><span class="token punctuation">,</span> path<span class="token punctuation">,</span> descriptor<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> Get <span class="token operator">=</span> <span class="token function">methodDecoratorFactory</span><span class="token punctuation">(</span><span class="token constant">REQUEST_METHOD</span><span class="token punctuation">.</span><span class="token constant">GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> Post <span class="token operator">=</span> <span class="token function">methodDecoratorFactory</span><span class="token punctuation">(</span><span class="token constant">REQUEST_METHOD</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>这样一来，<code>@Get(&quot;/list&quot;)</code> 其实就是注册了 <code>ioc:method - ioc:get</code>，<code>ioc:path - &quot;list&quot;</code> 这样的两对元数据，分别标识了请求方法与请求路径。需要注意的是，我们是在方法体上去注册的，这样在最终处理时，可以<strong>通过这个类的原型拿到方法体</strong>，继而获得注册的元数据。</p> <p>Controller 中就简单一些了，我们只需要拿到它的请求路径信息，然后拼接在这个类中所有请求方法的请求路径前即可：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token punctuation">(</span>path<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> ClassDecorator <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Reflect<span class="token punctuation">.</span><span class="token function">defineMetadata</span><span class="token punctuation">(</span><span class="token constant">METADATA_KEY</span><span class="token punctuation">.</span><span class="token constant">PATH</span><span class="token punctuation">,</span> path <span class="token operator">??</span> <span class="token string">''</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在最后信息组装时，我们需要做这么几步：</p> <ul><li>获取根路径，即 Controller 装饰器的入参</li> <li>获取这个类实例的原型对象</li> <li>在原型对象上基于方法名获得方法体，继而拿到定义的请求路径、请求方法、请求实现</li></ul> <p>来看实际代码：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">AsyncFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ICollected</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  requestMethod<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  requestHandler<span class="token operator">:</span> AsyncFunc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> routerFactory <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ins<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> ICollected<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prototype <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>ins<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> rootPath <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
    Reflect<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token constant">METADATA_KEY</span><span class="token punctuation">.</span><span class="token constant">PATH</span><span class="token punctuation">,</span> prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> methods <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
    Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>prototype<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item <span class="token operator">!==</span> <span class="token string">'constructor'</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> collected <span class="token operator">=</span> methods<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> requestHandler <span class="token operator">=</span> prototype<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span>Reflect<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token constant">METADATA_KEY</span><span class="token punctuation">.</span><span class="token constant">PATH</span><span class="token punctuation">,</span> requestHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> requestMethod <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
      Reflect<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token constant">METADATA_KEY</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> requestHandler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>
        <span class="token string">'ioc:'</span><span class="token punctuation">,</span>
        <span class="token string">''</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      requestMethod<span class="token punctuation">,</span>
      requestHandler<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> collected<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>对于开始我们给出的路由使用方法，收集到的最终信息是这样的：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> '/user/list'<span class="token punctuation">,</span>
    requestMethod<span class="token operator">:</span> 'get'<span class="token punctuation">,</span>
    requestHandler<span class="token operator">:</span> <span class="token punctuation">[</span>AsyncFunction<span class="token operator">:</span> userList<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> '/user/add'<span class="token punctuation">,</span>
    requestMethod<span class="token operator">:</span> 'post'<span class="token punctuation">,</span>
    requestHandler<span class="token operator">:</span> <span class="token punctuation">[</span>AsyncFunction<span class="token operator">:</span> addUser<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>现在我们就要来使用一个真正的 Node 服务来检验一下了，直接使用内置的 HTTP 模块启动一个服务器：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> http <span class="token keyword">from</span> <span class="token string">'http'</span><span class="token punctuation">;</span>

http
  <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'listening'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server ready at http://localhost:3000 \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>接下来我们需要做的，就是在 createServer 内去依据请求路径与请求方法调用对应的实现了。我们会遍历收集到的信息，查看是否有某一个对象的路径与请求方法都匹配上了，如果有，就调用这个方法返回：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>http
  <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> info <span class="token keyword">of</span> collected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        req<span class="token punctuation">.</span>url <span class="token operator">===</span> info<span class="token punctuation">.</span>path <span class="token operator">&amp;&amp;</span>
        req<span class="token punctuation">.</span>method <span class="token operator">===</span> info<span class="token punctuation">.</span>requestMethod<span class="token punctuation">.</span><span class="token function">toLocaleUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        info<span class="token punctuation">.</span><span class="token function">requestHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'listening'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server ready at http://localhost:3000 \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'GET /user/list at http://localhost:3000/user/list \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'POST /user/add at http://localhost:3000/user/add \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>在 Controller 中新增简单的方法返回：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">userList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      success<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      code<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'linbudu'</span><span class="token punctuation">,</span>
          age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'林不渡'</span><span class="token punctuation">,</span>
          age<span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">'/add'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      success<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      code<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>访问 <a href="https://link.juejin.cn/?target=http%3A%2F%2Flocalhost%3A3000%2Fuser%2Flist" target="_blank" rel="noopener noreferrer">http://localhost:3000/user/list<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来试一下：</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8f97f6adccf947c09bec6eb9e81a28b6~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img"></p> <p>成功了！是不是还有点小激动？你还可以试着加上同样基于装饰器的中间件、拦截器等机制，思路仍然是一致的：<strong>注册</strong>、<strong>提取</strong>、<strong>组装</strong>以及<strong>匹配调用</strong>。</p> <p>实际上，在 Nest 这一类框架中，通常会通过完整的容器机制来进行元数据的注册与提取，如 <code>routerFactory(new UserController())</code> 这一过程，其实就是在你从容器中取出这个类时就已经自动完成了的。那么，我们要如何实现一个如此贴心的容器？</p> <h2 id="实现一个简易-ioc-容器"><a href="#实现一个简易-ioc-容器" class="header-anchor">#</a> 实现一个简易 IoC 容器</h2> <p>实现一个简单的 IoC 容器可以很好地帮助我们总结装饰器、依赖注入、元数据的相关知识，以及理解“控制反转”的本质。</p> <p>关于这个容器，我们最终想实现的使用方式是这样的：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Driver</span> <span class="token punctuation">{</span>
  <span class="token function">adapt</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n === 驱动已生效于 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>consumer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">！===\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  driver<span class="token operator">!</span><span class="token operator">:</span> Driver<span class="token punctuation">;</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">adapt</span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> car <span class="token operator">=</span> Container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token punctuation">;</span>

car<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 驱动已生效于 Car ！</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>先来梳理一下思路，要实现这么个效果，首先我们需要一个容器，即控制反转中提到的<strong>独立的控制方</strong>，我们的 Car 依赖于驱动 Driver，这个容器会帮我们完成 Driver 注入到 Car 内的操作。那这个容器如何知道有哪些类需要被提前实例化呢？我们使用一个 Provide 装饰器，被其标记的 Class 会自动被容器收集。然后在需要使用这些类实例的地方，使用 Inject 装饰器声明这里需要哪个实例，容器就会自动地将这个属性注入进来。</p> <p>这里有一个比较复杂的地方，在存储一个类和注入一个类时，我们需要有一个标识符，才能实现一一对应的注入方式。在上面的例子里我们的 Provide 和 Inject 装饰器都是使用无参数调用的，这样的话标识符从何而来？你可能会想到使用内置的元数据信息！的确是这样，但是为了降低学习成本，我们先来了解如何不使用元数据来实现这个 IoC 容器，也就是我们能够这么使用：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token string">'DriverService'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Driver</span> <span class="token punctuation">{</span>
  <span class="token function">adapt</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n === 驱动已生效于 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>consumer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">！===\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token string">'DriverService'</span><span class="token punctuation">)</span>
  driver<span class="token operator">!</span><span class="token operator">:</span> Driver<span class="token punctuation">;</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">adapt</span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> car <span class="token operator">=</span> Container<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>Car<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>

car<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>这样的话就就简单多了，我们只需要基于字符串来存储、查找、注入一个类就好了。</p> <p>首先我们创建一个容器，很明显，它需要一个 Map 来以字符串-类的方式存储这些信息，以及 get 与 set 方法：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ClassStruct<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> services<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> ClassStruct<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> ClassStruct<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>我们使用私有构造函数来避免这个类被错误地实例化，毕竟它其实只是用来将这些逻辑收拢到一起。</p> <p>然后就像我们前面说的，Provide 和 Inject 装饰器需要进行存储与注入工作：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">Provide</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> ClassDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>Target<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Container<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> Target <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ClassStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Inject</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PropertyDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Provide 倒简单，但 Inject 就有些麻烦了，我们在前面提到属性装饰器是无法对类的属性进行操作的，因此我们这里只能使用委托的方式。也就是说，我们先告诉容器有哪些属性需要进行注入，以及需要注入的类的标识符，等我们从容器中去取这个类的时候，容器会帮我们处理这些。</p> <p>因此容器中需要再增加一个 Map，它的键与键值均为字符串类型：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> propertyRegistry<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这样在 Inject 中，我们需要做的就是注册信息：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">Inject</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PropertyDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Container<span class="token punctuation">.</span>propertyRegistry<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">String</span><span class="token punctuation">(</span>propertyKey<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      key
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>需要注意的是，这里我们注册的是 <code>Car:driver</code> - <code>DriverService</code> 的形式，以此来同时保存这个属性所在的类名称。</p> <p>接下来，我们需要做的就是 get 与 set 方法了。set 方法简单，直接注册 services 就好：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> ClassStruct<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    Container<span class="token punctuation">.</span>services<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>get 方法就要复杂一些了，它需要在我们取出一个类（<code>Container.get('Car')</code>）时，帮我们实例化这个类以及注入这个类内部声明的依赖（<code>DriverService</code>）。整理一下具体步骤：</p> <ul><li>使用传入的标识符在容器内查找这个类是否已经注册，如果有则进行下一步，没有就返回 undefined。</li> <li>对于已注册的类，首先将其实例化，然后检查 <code>propertyRegistry</code> ，查看这个类内部是否声明了对外部的依赖？</li> <li>将这些外部依赖的类从容器中取出（同样通过 get 方法），然后实例化。</li> <li>将这些实例传递给对应的属性。</li></ul> <p>我们的大致实现如下：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> ServiceKey<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span>
    <span class="token comment">// 检查是否注册</span>
    <span class="token keyword">const</span> Cons <span class="token operator">=</span> Container<span class="token punctuation">.</span>services<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Cons<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 实例化这个类</span>
    <span class="token keyword">const</span> ins <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cons</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 遍历注册信息</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> info <span class="token keyword">of</span> Container<span class="token punctuation">.</span>propertyRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 注入标识符与要注入类的标识符</span>
      <span class="token keyword">const</span> <span class="token punctuation">[</span>injectKey<span class="token punctuation">,</span> serviceKey<span class="token punctuation">]</span> <span class="token operator">=</span> info<span class="token punctuation">;</span>
      <span class="token comment">// 拆分为 Class 名与属性名</span>
      <span class="token keyword">const</span> <span class="token punctuation">[</span>classKey<span class="token punctuation">,</span> propKey<span class="token punctuation">]</span> <span class="token operator">=</span> injectKey<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 如果不是这个类，就跳过</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>classKey <span class="token operator">!==</span> Cons<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>

      <span class="token comment">// 取出需要注入的类，这里拿到的是已经实例化的</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> Container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>serviceKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 赋值给对应的属性</span>
        ins<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span> <span class="token operator">=</span> target<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> ins<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>来试着调用，会发现已经成功了：</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/93f2e0b4e48c490b9f30e9aaafcf361e~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img"></p> <p>每次传入字符串的实现肯定不够优雅，我们在使用 Nest、Angular 等框架时，也并不会经常使用字符串作为标识符来实现依赖注入。</p> <p>可是，如果不使用字符串，我们要用什么来作为标识符呢？聪明的你肯定想到了，可以使用内置的元数据来作为标识符，比如在这种情况下：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  driver<span class="token operator">!</span><span class="token operator">:</span> Driver<span class="token punctuation">;</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">adapt</span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>对于 driver 属性，我们就可以使用它的类型标注 Driver 来作为标识符。那接下来我们来改写上面的容器实现。</p> <h3 id="基于内置元数据实现"><a href="#基于内置元数据实现" class="header-anchor">#</a> 基于内置元数据实现</h3> <p>其实最难的一部分我们已经解决了，即如何存储并对应地进行注入，现在要做的不过是升级优化一下，支持在不传入标识符时使用内置元数据作为标识符。首先对 Provide 和 Inject 做改造：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">Provide</span><span class="token punctuation">(</span>key<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> ClassDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>Target<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Container<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key <span class="token operator">??</span> Target<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Target <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ClassStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Container<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Target<span class="token punctuation">,</span> Target <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ClassStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Inject</span><span class="token punctuation">(</span>key<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PropertyDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Container<span class="token punctuation">.</span>propertyRegistry<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">String</span><span class="token punctuation">(</span>propertyKey<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      key <span class="token operator">??</span> Reflect<span class="token punctuation">.</span><span class="token function">getMetadata</span><span class="token punctuation">(</span><span class="token string">'design:type'</span><span class="token punctuation">,</span> target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>本节的代码并没有在类型上进行十分精确的处理，这主要是为了避免增加额外的代码复杂度，毕竟我们的主要目的是<strong>理解依赖注入</strong>而不是类型。</p></blockquote> <p>在 Inject 中，我们支持了在不传入标识符时，使用 <code>Reflect.getMetadata('design:type', target, propertyKey)</code> 作为默认的标识符，这里的元数据是一个完整的类，即 Class Driver 。</p> <p>对应的，为了支持使用 Class 作为标识符进行查找，在 Provide 装饰器中我们需要确保也使用 Class 作为标识符来存储一份：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">Provide</span><span class="token punctuation">(</span>key<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> ClassDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>Target<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Container<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key <span class="token operator">??</span> Target<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Target <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ClassStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 不论是否传入 key，都使用 Class 作为 key 注册一份</span>
    Container<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Target<span class="token punctuation">,</span> Target <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ClassStruct<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>然后就没了！我们并不需要修改 Container 的逻辑，只需要调整类型即可：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ServiceKey<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> ClassStruct<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token builtin">Function</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> services<span class="token operator">:</span> Map<span class="token operator">&lt;</span>ServiceKey<span class="token punctuation">,</span> ClassStruct<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> propertyRegistry<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token operator">:</span> ServiceKey<span class="token punctuation">,</span> value<span class="token operator">:</span> ClassStruct<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> ServiceKey<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>现在我们可以同时使用 <code>@Inject()</code> 与 <code>@Inject('DriverService')</code> 这两种方式来实现注入了，来最后测试一下：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token string">'DriverService'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Driver</span> <span class="token punctuation">{</span>
  <span class="token function">adapt</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n === 驱动已生效于 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>consumer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">！===\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Fuel</span> <span class="token punctuation">{</span>
  <span class="token function">fill</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n === 燃料已填充完毕 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>consumer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">！===</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  driver<span class="token operator">!</span><span class="token operator">:</span> Driver<span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  fule<span class="token operator">!</span><span class="token operator">:</span> Fuel<span class="token punctuation">;</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fule<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">adapt</span><span class="token punctuation">(</span><span class="token string">'Car'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Provide</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Bus</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token string">'DriverService'</span><span class="token punctuation">)</span>
  driver<span class="token operator">!</span><span class="token operator">:</span> Driver<span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token string">'Fuel'</span><span class="token punctuation">)</span>
  fule<span class="token operator">!</span><span class="token operator">:</span> Fuel<span class="token punctuation">;</span>

  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fule<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">'Bus'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">adapt</span><span class="token punctuation">(</span><span class="token string">'Bus'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> car <span class="token operator">=</span> Container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>Car<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bus <span class="token operator">=</span> Container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>Bus<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>

car<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bus<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ac6238730204b18b08c2f87cae66ce5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p> <p>学习完这一节后，请你试着把上一部分的装饰器路由体系也基于这个简单的容器重新实现与改善，如新增对 Service 层与中间件层的注入：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 如何设计入参？</span>
<span class="token keyword">function</span> <span class="token function">logMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 中间件逻辑在何时执行？</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">private</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Middleware</span></span><span class="token punctuation">(</span>logMiddleware<span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">userList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">'/add'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">addUser</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="总结与预告"><a href="#总结与预告" class="header-anchor">#</a> 总结与预告</h2> <p>在这两节，我们花了相当长的篇幅对装饰器相关的概念与实际应用进行了一次彻底介绍。从装饰器语法到不同类型装饰器的使用，再到反射、反射元数据，最后到控制反转与依赖注入，以及简单的 IoC 路由与 IoC 容器实现。这些概念可以帮助你在使用基于装饰器的工具库时，更加熟悉其底层的原理。同时，如果你想自己开发一些基于装饰器的工具库，这一节的内容也是一个不错的开始。</p> <p>在接下来两节，我们将投入另一个方面的实战：TSConfig 配置解析。如果你也曾对着一堆配置较劲半天，却没看出个所以然的经历，这一次可以放心了。我们将在下面两节全面解析大部分配置，包括每一条配置的作用、表现以及与它关联的配置们。</p> <h2 id="扩展阅读"><a href="#扩展阅读" class="header-anchor">#</a> 扩展阅读</h2> <h3 id="类型严格的装饰器"><a href="#类型严格的装饰器" class="header-anchor">#</a> 类型严格的装饰器</h3> <p>在这一节的代码中，我们并没有特别关注类型的严格性。实际上装饰器的类型定义也是如此：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">type</span> <span class="token class-name">ClassDecorator</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>TFunction <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Function</span></span><span class="token operator">&gt;</span><span class="token punctuation">(</span>target<span class="token operator">:</span> TFunction<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> TFunction <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">type</span> <span class="token class-name">PropertyDecorator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token operator">:</span> Object<span class="token punctuation">,</span> propertyKey<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这些类型定义使用的是非常宽泛的类型， 并没有进行对应的约束。而如果将这些类型进行约束，实际上我们就可以实现一个类型严格的装饰器。如我们希望装饰器 <code>@OnlyFoo</code> 只能在 Foo 及其子类上应用，此时就可以通过约束 target 的类型实现：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ClassStruct<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">RestrictedClassDecorator<span class="token operator">&lt;</span>TClass <span class="token keyword">extends</span> object<span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  target<span class="token operator">:</span> ClassStruct<span class="token operator">&lt;</span>TClass<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ClassStruct<span class="token operator">&lt;</span>TClass<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">OnlyFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> RestrictedClassDecorator<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token operator">:</span> ClassStruct<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">OnlyBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> RestrictedClassDecorator<span class="token operator">&lt;</span>Bar<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token operator">:</span> ClassStruct<span class="token operator">&lt;</span>Bar<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>来实际使用一下：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyFoo</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 装饰器函数返回类型“void | ClassStruct&lt;Bar&gt;”不可分配到类型“void | typeof Foo”</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyBar</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  foo<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyFoo</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">DerivedFoo</span> <span class="token keyword">extends</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  foo<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 装饰器函数返回类型“void | ClassStruct&lt;Foo&gt;”不可分配到类型“void | typeof Bar”。</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyFoo</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyBar</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>
  bar<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>类似的，我们还可以实现约束方法装饰器只能在同步或异步函数上调用：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">AsyncFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">OnlyAsyncMethodDecorator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  target<span class="token operator">:</span> Object<span class="token punctuation">,</span>
  propertyKey<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">,</span>
  descriptor<span class="token operator">:</span> TypedPropertyDescriptor<span class="token operator">&lt;</span>AsyncFunc<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">OnlyAsyncFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OnlyAsyncMethodDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token comment">// 类型“TypedPropertyDescriptor&lt;() =&gt; void&gt;”的参数不能赋给类型“TypedPropertyDescriptor&lt;AsyncFunc&gt;”的参数。</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyAsyncFunc</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyAsyncFunc</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">asyncHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>以及属性装饰器只用应用在特定类型的属性上：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">LiteralPropertyDecorator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  target<span class="token operator">:</span> Object<span class="token punctuation">,</span>
  propertyKey<span class="token operator">:</span> <span class="token string">'linbudu'</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">OnlyLiteralProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> LiteralPropertyDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">PickByValueType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Value<span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Key <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">Value</span> <span class="token operator">?</span> Key <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">StringTypePropertyDecorator</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  target<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  propertyKey<span class="token operator">:</span> PickByValueType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">OnlyStringTypeProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> StringTypePropertyDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propertyKey<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyStringTypeProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  str<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token comment">// 类型“&quot;bool&quot;”的参数不能赋给类型“PickByValueType&lt;Foo, string&gt;”的参数。</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyStringTypeProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  bool<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OnlyLiteralProperty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  linbudu<span class="token operator">!</span><span class="token operator">:</span> <span class="token string">'linbudu'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>这里比较巧妙的是，由于我们只能获取到被装饰的属性名，无法直接获取到其类型，因此通过此前我们学习过的 PickByValueType 工具类型，将这个类上所有符合类型的属性名都提取了出来（作为字面量类型），然后使用这一字面量类型作为类型约束。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/25/2024, 11:59:12 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html" class="prev">
        /notes/ForentEnd/TypeScript/TypeScriptGuideAll/25.装饰器与反射元数据：了解装饰器基本原理与应用.html
      </a></span> <span class="next"><a href="/notes/ForentEnd/TypeScript/TypeScriptGuideAll/27.TSConfig 全解（上）：构建相关配置.html">
        /notes/ForentEnd/TypeScript/TypeScriptGuideAll/27.TSConfig 全解（上）：构建相关配置.html
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.73a5ecf6.js" defer></script><script src="/assets/js/2.590ae2eb.js" defer></script><script src="/assets/js/1.bccb620a.js" defer></script><script src="/assets/js/436.c728cef0.js" defer></script>
  </body>
</html>
