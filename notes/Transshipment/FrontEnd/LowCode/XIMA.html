<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>搭建平台如何构建页面 | Swell</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut con" type="image/x-icon" href="/favicon.ico">
    <meta name="description" content="2021, 学习进步!">
    
    <link rel="preload" href="/assets/css/0.styles.e31f0171.css" as="style"><link rel="preload" href="/assets/js/app.73a5ecf6.js" as="script"><link rel="preload" href="/assets/js/2.590ae2eb.js" as="script"><link rel="preload" href="/assets/js/1.bccb620a.js" as="script"><link rel="preload" href="/assets/js/487.dede7361.js" as="script"><link rel="prefetch" href="/assets/js/10.15f52ef6.js"><link rel="prefetch" href="/assets/js/100.61d0b64a.js"><link rel="prefetch" href="/assets/js/101.2acb61f2.js"><link rel="prefetch" href="/assets/js/102.cc751063.js"><link rel="prefetch" href="/assets/js/103.37b13de0.js"><link rel="prefetch" href="/assets/js/104.e261251b.js"><link rel="prefetch" href="/assets/js/105.0682bdef.js"><link rel="prefetch" href="/assets/js/106.af258742.js"><link rel="prefetch" href="/assets/js/107.103307e5.js"><link rel="prefetch" href="/assets/js/108.2042a201.js"><link rel="prefetch" href="/assets/js/109.0578731f.js"><link rel="prefetch" href="/assets/js/11.32a47492.js"><link rel="prefetch" href="/assets/js/110.d7a1a747.js"><link rel="prefetch" href="/assets/js/111.766a2999.js"><link rel="prefetch" href="/assets/js/112.d1c2833a.js"><link rel="prefetch" href="/assets/js/113.96bd50ed.js"><link rel="prefetch" href="/assets/js/114.11c4a3ba.js"><link rel="prefetch" href="/assets/js/115.00a93f85.js"><link rel="prefetch" href="/assets/js/116.fd649365.js"><link rel="prefetch" href="/assets/js/117.6d98debf.js"><link rel="prefetch" href="/assets/js/118.9bdee4c6.js"><link rel="prefetch" href="/assets/js/119.e5fcc0ca.js"><link rel="prefetch" href="/assets/js/12.a9377396.js"><link rel="prefetch" href="/assets/js/120.94a5f1eb.js"><link rel="prefetch" href="/assets/js/121.848c781c.js"><link rel="prefetch" href="/assets/js/122.c837c652.js"><link rel="prefetch" href="/assets/js/123.3db9a05d.js"><link rel="prefetch" href="/assets/js/124.1ae4b858.js"><link rel="prefetch" href="/assets/js/125.a79b8edb.js"><link rel="prefetch" href="/assets/js/126.5e12598c.js"><link rel="prefetch" href="/assets/js/127.57db96aa.js"><link rel="prefetch" href="/assets/js/128.428b8f6f.js"><link rel="prefetch" href="/assets/js/129.0b86e631.js"><link rel="prefetch" href="/assets/js/13.1357771b.js"><link rel="prefetch" href="/assets/js/130.75dfb8e2.js"><link rel="prefetch" href="/assets/js/131.67dd4855.js"><link rel="prefetch" href="/assets/js/132.b106df8c.js"><link rel="prefetch" href="/assets/js/133.c38efec5.js"><link rel="prefetch" href="/assets/js/134.1d49c265.js"><link rel="prefetch" href="/assets/js/135.09365786.js"><link rel="prefetch" href="/assets/js/136.9b1d494f.js"><link rel="prefetch" href="/assets/js/137.a355ea4b.js"><link rel="prefetch" href="/assets/js/138.e73bb572.js"><link rel="prefetch" href="/assets/js/139.3525cfb3.js"><link rel="prefetch" href="/assets/js/14.129948e8.js"><link rel="prefetch" href="/assets/js/140.2131c2c4.js"><link rel="prefetch" href="/assets/js/141.9ca5922a.js"><link rel="prefetch" href="/assets/js/142.cb9ed10a.js"><link rel="prefetch" href="/assets/js/143.04a6859e.js"><link rel="prefetch" href="/assets/js/144.72c11427.js"><link rel="prefetch" href="/assets/js/145.eece3ef3.js"><link rel="prefetch" href="/assets/js/146.caa6a0ec.js"><link rel="prefetch" href="/assets/js/147.e4ff2723.js"><link rel="prefetch" href="/assets/js/148.55f56cef.js"><link rel="prefetch" href="/assets/js/149.97a82a9e.js"><link rel="prefetch" href="/assets/js/15.60ba5750.js"><link rel="prefetch" href="/assets/js/150.7e3541b5.js"><link rel="prefetch" href="/assets/js/151.afb984a9.js"><link rel="prefetch" href="/assets/js/152.9e44b954.js"><link rel="prefetch" href="/assets/js/153.124289f6.js"><link rel="prefetch" href="/assets/js/154.6597518c.js"><link rel="prefetch" href="/assets/js/155.8b531821.js"><link rel="prefetch" href="/assets/js/156.75abab4a.js"><link rel="prefetch" href="/assets/js/157.3c64d55c.js"><link rel="prefetch" href="/assets/js/158.2561d095.js"><link rel="prefetch" href="/assets/js/159.314def34.js"><link rel="prefetch" href="/assets/js/16.434fa20b.js"><link rel="prefetch" href="/assets/js/160.c47e3bdc.js"><link rel="prefetch" href="/assets/js/161.2756adf0.js"><link rel="prefetch" href="/assets/js/162.d0702a97.js"><link rel="prefetch" href="/assets/js/163.15ec5879.js"><link rel="prefetch" href="/assets/js/164.be28b05d.js"><link rel="prefetch" href="/assets/js/165.ad18ab78.js"><link rel="prefetch" href="/assets/js/166.c7b2579a.js"><link rel="prefetch" href="/assets/js/167.9a1a27ae.js"><link rel="prefetch" href="/assets/js/168.a63db718.js"><link rel="prefetch" href="/assets/js/169.72d60f8a.js"><link rel="prefetch" href="/assets/js/17.3db09ca6.js"><link rel="prefetch" href="/assets/js/170.26911f2c.js"><link rel="prefetch" href="/assets/js/171.35b59af1.js"><link rel="prefetch" href="/assets/js/172.92e4aeaa.js"><link rel="prefetch" href="/assets/js/173.ee3d9ade.js"><link rel="prefetch" href="/assets/js/174.7cb0604e.js"><link rel="prefetch" href="/assets/js/175.58f66365.js"><link rel="prefetch" href="/assets/js/176.5c71c1eb.js"><link rel="prefetch" href="/assets/js/177.37f53d06.js"><link rel="prefetch" href="/assets/js/178.249b498a.js"><link rel="prefetch" href="/assets/js/179.c795c950.js"><link rel="prefetch" href="/assets/js/18.f9f8a7d5.js"><link rel="prefetch" href="/assets/js/180.7b0c1ea3.js"><link rel="prefetch" href="/assets/js/181.be0e946d.js"><link rel="prefetch" href="/assets/js/182.b435f95d.js"><link rel="prefetch" href="/assets/js/183.b91027d4.js"><link rel="prefetch" href="/assets/js/184.f1c8d5eb.js"><link rel="prefetch" href="/assets/js/185.238c1129.js"><link rel="prefetch" href="/assets/js/186.d5ff2a54.js"><link rel="prefetch" href="/assets/js/187.dba21a64.js"><link rel="prefetch" href="/assets/js/188.70530b62.js"><link rel="prefetch" href="/assets/js/189.0477f6c9.js"><link rel="prefetch" href="/assets/js/19.da0d0d64.js"><link rel="prefetch" href="/assets/js/190.011a7dc3.js"><link rel="prefetch" href="/assets/js/191.72cde41e.js"><link rel="prefetch" href="/assets/js/192.40336c25.js"><link rel="prefetch" href="/assets/js/193.0da143ab.js"><link rel="prefetch" href="/assets/js/194.0241ed0f.js"><link rel="prefetch" href="/assets/js/195.b750b3d2.js"><link rel="prefetch" href="/assets/js/196.ce5139eb.js"><link rel="prefetch" href="/assets/js/197.600c2192.js"><link rel="prefetch" href="/assets/js/198.ca857430.js"><link rel="prefetch" href="/assets/js/199.d35856a6.js"><link rel="prefetch" href="/assets/js/20.948940b4.js"><link rel="prefetch" href="/assets/js/200.2662b113.js"><link rel="prefetch" href="/assets/js/201.0f62685f.js"><link rel="prefetch" href="/assets/js/202.ec52b31d.js"><link rel="prefetch" href="/assets/js/203.76d276b6.js"><link rel="prefetch" href="/assets/js/204.24636359.js"><link rel="prefetch" href="/assets/js/205.376d0c2c.js"><link rel="prefetch" href="/assets/js/206.681e208a.js"><link rel="prefetch" href="/assets/js/207.29b7ecd7.js"><link rel="prefetch" href="/assets/js/208.f38558c4.js"><link rel="prefetch" href="/assets/js/209.947fab6b.js"><link rel="prefetch" href="/assets/js/21.ffab7a62.js"><link rel="prefetch" href="/assets/js/210.45adef84.js"><link rel="prefetch" href="/assets/js/211.97bbbb16.js"><link rel="prefetch" href="/assets/js/212.3f9d660e.js"><link rel="prefetch" href="/assets/js/213.935cd19f.js"><link rel="prefetch" href="/assets/js/214.bb38d432.js"><link rel="prefetch" href="/assets/js/215.f2fe281a.js"><link rel="prefetch" href="/assets/js/216.e296c9f9.js"><link rel="prefetch" href="/assets/js/217.8f6dbf39.js"><link rel="prefetch" href="/assets/js/218.045a0cc1.js"><link rel="prefetch" href="/assets/js/219.58df4a99.js"><link rel="prefetch" href="/assets/js/22.f0750ced.js"><link rel="prefetch" href="/assets/js/220.f68d303a.js"><link rel="prefetch" href="/assets/js/221.05da8f02.js"><link rel="prefetch" href="/assets/js/222.60099e9e.js"><link rel="prefetch" href="/assets/js/223.5825abcb.js"><link rel="prefetch" href="/assets/js/224.f4d99f78.js"><link rel="prefetch" href="/assets/js/225.60ede1ac.js"><link rel="prefetch" href="/assets/js/226.e7763dee.js"><link rel="prefetch" href="/assets/js/227.63c5ae52.js"><link rel="prefetch" href="/assets/js/228.9931d7cb.js"><link rel="prefetch" href="/assets/js/229.2897f6cc.js"><link rel="prefetch" href="/assets/js/23.283ccf93.js"><link rel="prefetch" href="/assets/js/230.c4a51166.js"><link rel="prefetch" href="/assets/js/231.6d53d108.js"><link rel="prefetch" href="/assets/js/232.b6c1a649.js"><link rel="prefetch" href="/assets/js/233.b6bb02d0.js"><link rel="prefetch" href="/assets/js/234.c355f3f3.js"><link rel="prefetch" href="/assets/js/235.075c0233.js"><link rel="prefetch" href="/assets/js/236.8f9ef9de.js"><link rel="prefetch" href="/assets/js/237.6b7cfc49.js"><link rel="prefetch" href="/assets/js/238.edfd425e.js"><link rel="prefetch" href="/assets/js/239.e2a85a98.js"><link rel="prefetch" href="/assets/js/24.549c92e1.js"><link rel="prefetch" href="/assets/js/240.f82824ab.js"><link rel="prefetch" href="/assets/js/241.41117afc.js"><link rel="prefetch" href="/assets/js/242.c2def09d.js"><link rel="prefetch" href="/assets/js/243.7e7c309d.js"><link rel="prefetch" href="/assets/js/244.b4836d63.js"><link rel="prefetch" href="/assets/js/245.e9b28214.js"><link rel="prefetch" href="/assets/js/246.edad5b50.js"><link rel="prefetch" href="/assets/js/247.9139b4e7.js"><link rel="prefetch" href="/assets/js/248.a41aedec.js"><link rel="prefetch" href="/assets/js/249.fd740137.js"><link rel="prefetch" href="/assets/js/25.f5416b6b.js"><link rel="prefetch" href="/assets/js/250.c6f68ffb.js"><link rel="prefetch" href="/assets/js/251.b0574d28.js"><link rel="prefetch" href="/assets/js/252.12320ad4.js"><link rel="prefetch" href="/assets/js/253.0a85a88b.js"><link rel="prefetch" href="/assets/js/254.8fd5a710.js"><link rel="prefetch" href="/assets/js/255.4f3061e8.js"><link rel="prefetch" href="/assets/js/256.6f3a49d3.js"><link rel="prefetch" href="/assets/js/257.5a61d2a2.js"><link rel="prefetch" href="/assets/js/258.2e3a86c4.js"><link rel="prefetch" href="/assets/js/259.deb76784.js"><link rel="prefetch" href="/assets/js/26.47adf9d4.js"><link rel="prefetch" href="/assets/js/260.77519cfe.js"><link rel="prefetch" href="/assets/js/261.25ba0f87.js"><link rel="prefetch" href="/assets/js/262.e92b5de5.js"><link rel="prefetch" href="/assets/js/263.031828ff.js"><link rel="prefetch" href="/assets/js/264.0179601d.js"><link rel="prefetch" href="/assets/js/265.277b1913.js"><link rel="prefetch" href="/assets/js/266.ceef02f4.js"><link rel="prefetch" href="/assets/js/267.e556946a.js"><link rel="prefetch" href="/assets/js/268.f1f1fe93.js"><link rel="prefetch" href="/assets/js/269.68cb4b59.js"><link rel="prefetch" href="/assets/js/27.fdf58993.js"><link rel="prefetch" href="/assets/js/270.922a1bee.js"><link rel="prefetch" href="/assets/js/271.bcefd25b.js"><link rel="prefetch" href="/assets/js/272.c06e3568.js"><link rel="prefetch" href="/assets/js/273.94b0334e.js"><link rel="prefetch" href="/assets/js/274.6a12df1b.js"><link rel="prefetch" href="/assets/js/275.75a2ab5b.js"><link rel="prefetch" href="/assets/js/276.966002fe.js"><link rel="prefetch" href="/assets/js/277.3f5d1117.js"><link rel="prefetch" href="/assets/js/278.1cd76f2f.js"><link rel="prefetch" href="/assets/js/279.c7124168.js"><link rel="prefetch" href="/assets/js/28.87aace24.js"><link rel="prefetch" href="/assets/js/280.252d2aa6.js"><link rel="prefetch" href="/assets/js/281.8fca868e.js"><link rel="prefetch" href="/assets/js/282.fcfd620c.js"><link rel="prefetch" href="/assets/js/283.3e0b94b7.js"><link rel="prefetch" href="/assets/js/284.523b96ff.js"><link rel="prefetch" href="/assets/js/285.85cf77f9.js"><link rel="prefetch" href="/assets/js/286.abff2675.js"><link rel="prefetch" href="/assets/js/287.d744429b.js"><link rel="prefetch" href="/assets/js/288.2f7aae1a.js"><link rel="prefetch" href="/assets/js/289.d37641c2.js"><link rel="prefetch" href="/assets/js/29.f624641d.js"><link rel="prefetch" href="/assets/js/290.c90625e0.js"><link rel="prefetch" href="/assets/js/291.6f078ea0.js"><link rel="prefetch" href="/assets/js/292.10db5141.js"><link rel="prefetch" href="/assets/js/293.c2b10f03.js"><link rel="prefetch" href="/assets/js/294.493f7a91.js"><link rel="prefetch" href="/assets/js/295.03545ba9.js"><link rel="prefetch" href="/assets/js/296.0f878bcd.js"><link rel="prefetch" href="/assets/js/297.9dfb1869.js"><link rel="prefetch" href="/assets/js/298.cea4af99.js"><link rel="prefetch" href="/assets/js/299.0fa93e26.js"><link rel="prefetch" href="/assets/js/3.d321bae9.js"><link rel="prefetch" href="/assets/js/30.a9b3d27a.js"><link rel="prefetch" href="/assets/js/300.c12dda56.js"><link rel="prefetch" href="/assets/js/301.5b465bca.js"><link rel="prefetch" href="/assets/js/302.56be3ec1.js"><link rel="prefetch" href="/assets/js/303.6163a9da.js"><link rel="prefetch" href="/assets/js/304.8d1fa21a.js"><link rel="prefetch" href="/assets/js/305.e3af5ad8.js"><link rel="prefetch" href="/assets/js/306.787f8b4f.js"><link rel="prefetch" href="/assets/js/307.7bb2044c.js"><link rel="prefetch" href="/assets/js/308.939fe0dc.js"><link rel="prefetch" href="/assets/js/309.105ade61.js"><link rel="prefetch" href="/assets/js/31.4f87f432.js"><link rel="prefetch" href="/assets/js/310.23d3283d.js"><link rel="prefetch" href="/assets/js/311.fb07ad70.js"><link rel="prefetch" href="/assets/js/312.a0c7fb17.js"><link rel="prefetch" href="/assets/js/313.3c7d78df.js"><link rel="prefetch" href="/assets/js/314.a640628b.js"><link rel="prefetch" href="/assets/js/315.9f58262d.js"><link rel="prefetch" href="/assets/js/316.0679c439.js"><link rel="prefetch" href="/assets/js/317.58cefee8.js"><link rel="prefetch" href="/assets/js/318.f89c86a9.js"><link rel="prefetch" href="/assets/js/319.5c9b58dd.js"><link rel="prefetch" href="/assets/js/32.2d66ef98.js"><link rel="prefetch" href="/assets/js/320.cb30281f.js"><link rel="prefetch" href="/assets/js/321.58711745.js"><link rel="prefetch" href="/assets/js/322.9fb45200.js"><link rel="prefetch" href="/assets/js/323.08f066c1.js"><link rel="prefetch" href="/assets/js/324.ab20ff92.js"><link rel="prefetch" href="/assets/js/325.4bbe8bcc.js"><link rel="prefetch" href="/assets/js/326.e8f257de.js"><link rel="prefetch" href="/assets/js/327.b7922a24.js"><link rel="prefetch" href="/assets/js/328.612faf69.js"><link rel="prefetch" href="/assets/js/329.18cb9234.js"><link rel="prefetch" href="/assets/js/33.262157a7.js"><link rel="prefetch" href="/assets/js/330.d810de8c.js"><link rel="prefetch" href="/assets/js/331.66f12117.js"><link rel="prefetch" href="/assets/js/332.16527475.js"><link rel="prefetch" href="/assets/js/333.b4a0d6e8.js"><link rel="prefetch" href="/assets/js/334.c4979f8e.js"><link rel="prefetch" href="/assets/js/335.1fff99de.js"><link rel="prefetch" href="/assets/js/336.c149bfa0.js"><link rel="prefetch" href="/assets/js/337.6dc650a0.js"><link rel="prefetch" href="/assets/js/338.84ae317b.js"><link rel="prefetch" href="/assets/js/339.fcc65273.js"><link rel="prefetch" href="/assets/js/34.9949ec5d.js"><link rel="prefetch" href="/assets/js/340.949a7827.js"><link rel="prefetch" href="/assets/js/341.cd7c5de6.js"><link rel="prefetch" href="/assets/js/342.9073f1c6.js"><link rel="prefetch" href="/assets/js/343.853dffc8.js"><link rel="prefetch" href="/assets/js/344.ee9817ad.js"><link rel="prefetch" href="/assets/js/345.fd1a3efe.js"><link rel="prefetch" href="/assets/js/346.10fa8918.js"><link rel="prefetch" href="/assets/js/347.e45c01e6.js"><link rel="prefetch" href="/assets/js/348.daef24fa.js"><link rel="prefetch" href="/assets/js/349.79f84f02.js"><link rel="prefetch" href="/assets/js/35.42dbe1ae.js"><link rel="prefetch" href="/assets/js/350.f5303241.js"><link rel="prefetch" href="/assets/js/351.44ebc7dd.js"><link rel="prefetch" href="/assets/js/352.a1433337.js"><link rel="prefetch" href="/assets/js/353.37c41c1c.js"><link rel="prefetch" href="/assets/js/354.b8bcaf81.js"><link rel="prefetch" href="/assets/js/355.3fdd463f.js"><link rel="prefetch" href="/assets/js/356.b263cbca.js"><link rel="prefetch" href="/assets/js/357.a6fde844.js"><link rel="prefetch" href="/assets/js/358.cffcdc1a.js"><link rel="prefetch" href="/assets/js/359.bf845a92.js"><link rel="prefetch" href="/assets/js/36.f54de322.js"><link rel="prefetch" href="/assets/js/360.6e89ae62.js"><link rel="prefetch" href="/assets/js/361.b51e86d2.js"><link rel="prefetch" href="/assets/js/362.71e4d67f.js"><link rel="prefetch" href="/assets/js/363.c96217a7.js"><link rel="prefetch" href="/assets/js/364.8b1960d8.js"><link rel="prefetch" href="/assets/js/365.243a5839.js"><link rel="prefetch" href="/assets/js/366.2ff73822.js"><link rel="prefetch" href="/assets/js/367.f6651e21.js"><link rel="prefetch" href="/assets/js/368.d7450f89.js"><link rel="prefetch" href="/assets/js/369.fd7af554.js"><link rel="prefetch" href="/assets/js/37.d257ac56.js"><link rel="prefetch" href="/assets/js/370.0bbbe839.js"><link rel="prefetch" href="/assets/js/371.9c073767.js"><link rel="prefetch" href="/assets/js/372.a4d4cd69.js"><link rel="prefetch" href="/assets/js/373.eb142bb9.js"><link rel="prefetch" href="/assets/js/374.34d1a792.js"><link rel="prefetch" href="/assets/js/375.ef1814ae.js"><link rel="prefetch" href="/assets/js/376.2e7e35dd.js"><link rel="prefetch" href="/assets/js/377.2bea8bea.js"><link rel="prefetch" href="/assets/js/378.e1bbe6f5.js"><link rel="prefetch" href="/assets/js/379.a693e336.js"><link rel="prefetch" href="/assets/js/38.c99f6657.js"><link rel="prefetch" href="/assets/js/380.018ee343.js"><link rel="prefetch" href="/assets/js/381.80d84aa4.js"><link rel="prefetch" href="/assets/js/382.1569da57.js"><link rel="prefetch" href="/assets/js/383.f7d4fc06.js"><link rel="prefetch" href="/assets/js/384.7f3e2055.js"><link rel="prefetch" href="/assets/js/385.6a25d774.js"><link rel="prefetch" href="/assets/js/386.fc9cb4b9.js"><link rel="prefetch" href="/assets/js/387.fc40d3d9.js"><link rel="prefetch" href="/assets/js/388.51191a8c.js"><link rel="prefetch" href="/assets/js/389.5210b974.js"><link rel="prefetch" href="/assets/js/39.c39c0252.js"><link rel="prefetch" href="/assets/js/390.ab328e43.js"><link rel="prefetch" href="/assets/js/391.46d950c7.js"><link rel="prefetch" href="/assets/js/392.b2213afe.js"><link rel="prefetch" href="/assets/js/393.246ac08c.js"><link rel="prefetch" href="/assets/js/394.dc519b93.js"><link rel="prefetch" href="/assets/js/395.d370b54e.js"><link rel="prefetch" href="/assets/js/396.21bf2546.js"><link rel="prefetch" href="/assets/js/397.b944e3dd.js"><link rel="prefetch" href="/assets/js/398.b53f1146.js"><link rel="prefetch" href="/assets/js/399.3e797024.js"><link rel="prefetch" href="/assets/js/4.952753dd.js"><link rel="prefetch" href="/assets/js/40.aeb3e8e9.js"><link rel="prefetch" href="/assets/js/400.4375d8bb.js"><link rel="prefetch" href="/assets/js/401.ef5bda6e.js"><link rel="prefetch" href="/assets/js/402.24339925.js"><link rel="prefetch" href="/assets/js/403.30020bfb.js"><link rel="prefetch" href="/assets/js/404.97cf7983.js"><link rel="prefetch" href="/assets/js/405.94cec870.js"><link rel="prefetch" href="/assets/js/406.d15dbab5.js"><link rel="prefetch" href="/assets/js/407.04787171.js"><link rel="prefetch" href="/assets/js/408.1a2e9af2.js"><link rel="prefetch" href="/assets/js/409.a5cc2024.js"><link rel="prefetch" href="/assets/js/41.2f2d275c.js"><link rel="prefetch" href="/assets/js/410.dbbef180.js"><link rel="prefetch" href="/assets/js/411.d762bcd5.js"><link rel="prefetch" href="/assets/js/412.54ae71e5.js"><link rel="prefetch" href="/assets/js/413.f3ce412a.js"><link rel="prefetch" href="/assets/js/414.004f8093.js"><link rel="prefetch" href="/assets/js/415.e23a63de.js"><link rel="prefetch" href="/assets/js/416.4cb1ec0c.js"><link rel="prefetch" href="/assets/js/417.cf435f4e.js"><link rel="prefetch" href="/assets/js/418.0bc0ac91.js"><link rel="prefetch" href="/assets/js/419.5540565a.js"><link rel="prefetch" href="/assets/js/42.d1a59707.js"><link rel="prefetch" href="/assets/js/420.83bca0e5.js"><link rel="prefetch" href="/assets/js/421.62f5048f.js"><link rel="prefetch" href="/assets/js/422.0051f244.js"><link rel="prefetch" href="/assets/js/423.302e5ec0.js"><link rel="prefetch" href="/assets/js/424.fe376e48.js"><link rel="prefetch" href="/assets/js/425.1eb95e2b.js"><link rel="prefetch" href="/assets/js/426.80f36ff2.js"><link rel="prefetch" href="/assets/js/427.4a0a2482.js"><link rel="prefetch" href="/assets/js/428.42f7db97.js"><link rel="prefetch" href="/assets/js/429.c65e4b4e.js"><link rel="prefetch" href="/assets/js/43.db6fab67.js"><link rel="prefetch" href="/assets/js/430.8589ad49.js"><link rel="prefetch" href="/assets/js/431.c4578f04.js"><link rel="prefetch" href="/assets/js/432.560e209c.js"><link rel="prefetch" href="/assets/js/433.985be6b0.js"><link rel="prefetch" href="/assets/js/434.e681afda.js"><link rel="prefetch" href="/assets/js/435.ad089b11.js"><link rel="prefetch" href="/assets/js/436.c728cef0.js"><link rel="prefetch" href="/assets/js/437.c562f870.js"><link rel="prefetch" href="/assets/js/438.ec965223.js"><link rel="prefetch" href="/assets/js/439.0fe4e944.js"><link rel="prefetch" href="/assets/js/44.09ac75e5.js"><link rel="prefetch" href="/assets/js/440.db944733.js"><link rel="prefetch" href="/assets/js/441.f5aa8d31.js"><link rel="prefetch" href="/assets/js/442.9761dd62.js"><link rel="prefetch" href="/assets/js/443.15c87d61.js"><link rel="prefetch" href="/assets/js/444.f39a19ae.js"><link rel="prefetch" href="/assets/js/445.f47183ad.js"><link rel="prefetch" href="/assets/js/446.b0c0e2fd.js"><link rel="prefetch" href="/assets/js/447.312d1c26.js"><link rel="prefetch" href="/assets/js/448.35ff7716.js"><link rel="prefetch" href="/assets/js/449.ad05d0b5.js"><link rel="prefetch" href="/assets/js/45.a3a5b2c5.js"><link rel="prefetch" href="/assets/js/450.ac24ea07.js"><link rel="prefetch" href="/assets/js/451.0c28ec36.js"><link rel="prefetch" href="/assets/js/452.1d4dc3cf.js"><link rel="prefetch" href="/assets/js/453.0de4724f.js"><link rel="prefetch" href="/assets/js/454.e45a4fd7.js"><link rel="prefetch" href="/assets/js/455.34a99165.js"><link rel="prefetch" href="/assets/js/456.2888615b.js"><link rel="prefetch" href="/assets/js/457.de1dd8e6.js"><link rel="prefetch" href="/assets/js/458.9f78503b.js"><link rel="prefetch" href="/assets/js/459.6ee6edc5.js"><link rel="prefetch" href="/assets/js/46.27102d42.js"><link rel="prefetch" href="/assets/js/460.4591a610.js"><link rel="prefetch" href="/assets/js/461.7d650e21.js"><link rel="prefetch" href="/assets/js/462.721db687.js"><link rel="prefetch" href="/assets/js/463.cb10e827.js"><link rel="prefetch" href="/assets/js/464.80f26301.js"><link rel="prefetch" href="/assets/js/465.c4a089d8.js"><link rel="prefetch" href="/assets/js/466.56b33a0f.js"><link rel="prefetch" href="/assets/js/467.af44f17d.js"><link rel="prefetch" href="/assets/js/468.b30f9487.js"><link rel="prefetch" href="/assets/js/469.543368f0.js"><link rel="prefetch" href="/assets/js/47.20b472c8.js"><link rel="prefetch" href="/assets/js/470.bd63a88e.js"><link rel="prefetch" href="/assets/js/471.9046c822.js"><link rel="prefetch" href="/assets/js/472.e76cf70c.js"><link rel="prefetch" href="/assets/js/473.70e10eb1.js"><link rel="prefetch" href="/assets/js/474.366ca9a6.js"><link rel="prefetch" href="/assets/js/475.473d542d.js"><link rel="prefetch" href="/assets/js/476.044b3917.js"><link rel="prefetch" href="/assets/js/477.0a850fed.js"><link rel="prefetch" href="/assets/js/478.93a186ed.js"><link rel="prefetch" href="/assets/js/479.ae0d7150.js"><link rel="prefetch" href="/assets/js/48.07ae4944.js"><link rel="prefetch" href="/assets/js/480.fca7692f.js"><link rel="prefetch" href="/assets/js/481.e19a44cb.js"><link rel="prefetch" href="/assets/js/482.ff4e7770.js"><link rel="prefetch" href="/assets/js/483.0c578313.js"><link rel="prefetch" href="/assets/js/484.1c5e8226.js"><link rel="prefetch" href="/assets/js/485.0ccfe11f.js"><link rel="prefetch" href="/assets/js/486.a63fd360.js"><link rel="prefetch" href="/assets/js/488.03a6015d.js"><link rel="prefetch" href="/assets/js/489.793d83a8.js"><link rel="prefetch" href="/assets/js/49.9ff049f0.js"><link rel="prefetch" href="/assets/js/5.83a3ae03.js"><link rel="prefetch" href="/assets/js/50.8b04e8ce.js"><link rel="prefetch" href="/assets/js/51.3b944dd7.js"><link rel="prefetch" href="/assets/js/52.5880437c.js"><link rel="prefetch" href="/assets/js/53.49708fd4.js"><link rel="prefetch" href="/assets/js/54.d9d38f4a.js"><link rel="prefetch" href="/assets/js/55.45398666.js"><link rel="prefetch" href="/assets/js/56.62aa6a24.js"><link rel="prefetch" href="/assets/js/57.54197e24.js"><link rel="prefetch" href="/assets/js/58.e9807d81.js"><link rel="prefetch" href="/assets/js/59.987e0900.js"><link rel="prefetch" href="/assets/js/6.3360b31d.js"><link rel="prefetch" href="/assets/js/60.78d6f828.js"><link rel="prefetch" href="/assets/js/61.4b8596e3.js"><link rel="prefetch" href="/assets/js/62.c778d9df.js"><link rel="prefetch" href="/assets/js/63.ed842070.js"><link rel="prefetch" href="/assets/js/64.97f4283c.js"><link rel="prefetch" href="/assets/js/65.17b7afc7.js"><link rel="prefetch" href="/assets/js/66.192eaeb7.js"><link rel="prefetch" href="/assets/js/67.4006440a.js"><link rel="prefetch" href="/assets/js/68.4ddc1758.js"><link rel="prefetch" href="/assets/js/69.83787533.js"><link rel="prefetch" href="/assets/js/7.7718c6cb.js"><link rel="prefetch" href="/assets/js/70.3fa97a66.js"><link rel="prefetch" href="/assets/js/71.6175bdc1.js"><link rel="prefetch" href="/assets/js/72.a830c52e.js"><link rel="prefetch" href="/assets/js/73.374b6f7b.js"><link rel="prefetch" href="/assets/js/74.84391a89.js"><link rel="prefetch" href="/assets/js/75.80da576a.js"><link rel="prefetch" href="/assets/js/76.f4d7aba3.js"><link rel="prefetch" href="/assets/js/77.273a23c1.js"><link rel="prefetch" href="/assets/js/78.77ccfc62.js"><link rel="prefetch" href="/assets/js/79.a630b51b.js"><link rel="prefetch" href="/assets/js/80.89987a90.js"><link rel="prefetch" href="/assets/js/81.36429fca.js"><link rel="prefetch" href="/assets/js/82.229eba74.js"><link rel="prefetch" href="/assets/js/83.61046aa4.js"><link rel="prefetch" href="/assets/js/84.9dc0748b.js"><link rel="prefetch" href="/assets/js/85.a68cf375.js"><link rel="prefetch" href="/assets/js/86.83bd1812.js"><link rel="prefetch" href="/assets/js/87.8717162b.js"><link rel="prefetch" href="/assets/js/88.a584da3f.js"><link rel="prefetch" href="/assets/js/89.237c4fa9.js"><link rel="prefetch" href="/assets/js/90.9edcc6e0.js"><link rel="prefetch" href="/assets/js/91.56ac1f6e.js"><link rel="prefetch" href="/assets/js/92.5ab8b643.js"><link rel="prefetch" href="/assets/js/93.6a041412.js"><link rel="prefetch" href="/assets/js/94.9965cb67.js"><link rel="prefetch" href="/assets/js/95.24318fa3.js"><link rel="prefetch" href="/assets/js/96.b0ba8371.js"><link rel="prefetch" href="/assets/js/97.1332aa21.js"><link rel="prefetch" href="/assets/js/98.36f085f4.js"><link rel="prefetch" href="/assets/js/99.0fbd1a6b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.70bf0358.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e31f0171.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Swell</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/TypeScript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/ReactSourceCode/" class="nav-link">
  React源码
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Regex/" class="nav-link">
  正则表达式
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Eslint/" class="nav-link">
  Eslint
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Component/" class="nav-link">
  组件封装
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Performance/" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Utils/" class="nav-link">
  常用工具
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CaseQuestions/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Test/" class="nav-link">
  单元测试
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Monitor/" class="nav-link">
  前端监控
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Babel/" class="nav-link">
  Babel
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/MicroFrontEnd/" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/LowCode/" class="nav-link">
  低代码
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="AI" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/AI/Code/" class="nav-link">
  代码
</a></li><li class="dropdown-item"><!----> <a href="/notes/AI/Chat/" class="nav-link">
  聊天
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="转载文章" class="dropdown-title"><span class="title">转载文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="转载文章" class="mobile-dropdown-title"><span class="title">转载文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Transshipment/FrontEnd/" class="nav-link router-link-active">
  前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务" class="dropdown-title"><span class="title">业务</span> <span class="arrow down"></span></button> <button type="button" aria-label="业务" class="mobile-dropdown-title"><span class="title">业务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Business/XIXIMA/" class="nav-link">
  XIXIMA
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow down"></span></button> <button type="button" aria-label="代码管理" class="mobile-dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/NPM/" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Lerna/" class="nav-link">
  Lerna
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/GitHub/" class="nav-link">
  GitHub
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Tools/Jenkins/" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Vscode/" class="nav-link">
  VsCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Editor/" class="nav-link">
  Editor
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCode/" class="nav-link">
  LeetCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCodeClass/" class="nav-link">
  分类
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Databases/MySql/" class="nav-link">
  MySql
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/18355166248" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/TypeScript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/HTML/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/ReactSourceCode/" class="nav-link">
  React源码
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Regex/" class="nav-link">
  正则表达式
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Eslint/" class="nav-link">
  Eslint
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Component/" class="nav-link">
  组件封装
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Performance/" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Utils/" class="nav-link">
  常用工具
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/CaseQuestions/" class="nav-link">
  面试题
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Test/" class="nav-link">
  单元测试
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Monitor/" class="nav-link">
  前端监控
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/Babel/" class="nav-link">
  Babel
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/MicroFrontEnd/" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/notes/ForentEnd/LowCode/" class="nav-link">
  低代码
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AI" class="dropdown-title"><span class="title">AI</span> <span class="arrow down"></span></button> <button type="button" aria-label="AI" class="mobile-dropdown-title"><span class="title">AI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/AI/Code/" class="nav-link">
  代码
</a></li><li class="dropdown-item"><!----> <a href="/notes/AI/Chat/" class="nav-link">
  聊天
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="转载文章" class="dropdown-title"><span class="title">转载文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="转载文章" class="mobile-dropdown-title"><span class="title">转载文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Transshipment/FrontEnd/" class="nav-link router-link-active">
  前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务" class="dropdown-title"><span class="title">业务</span> <span class="arrow down"></span></button> <button type="button" aria-label="业务" class="mobile-dropdown-title"><span class="title">业务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Business/XIXIMA/" class="nav-link">
  XIXIMA
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow down"></span></button> <button type="button" aria-label="代码管理" class="mobile-dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/NPM/" class="nav-link">
  NPM
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/Lerna/" class="nav-link">
  Lerna
</a></li><li class="dropdown-item"><!----> <a href="/notes/CodeManage/GitHub/" class="nav-link">
  GitHub
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Tools/Jenkins/" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Vscode/" class="nav-link">
  VsCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Tools/Editor/" class="nav-link">
  Editor
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCode/" class="nav-link">
  LeetCode
</a></li><li class="dropdown-item"><!----> <a href="/notes/Algorithm/LeetCodeClass/" class="nav-link">
  分类
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/Databases/MySql/" class="nav-link">
  MySql
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/18355166248" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/notes/Transshipment/FrontEnd/" aria-current="page" class="sidebar-link">转载</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/Transshipment/FrontEnd/" aria-current="page" class="sidebar-link">转载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Transshipment/FrontEnd/#前言" class="sidebar-link">前言</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/Transshipment/FrontEnd/LowCode/XIMA.html" aria-current="page" class="active sidebar-link">搭建平台如何构建页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/Transshipment/FrontEnd/LowCode/XIMA.html#线上项目说明" class="sidebar-link">线上项目说明</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/Transshipment/FrontEnd/ReactNative/yarn-link.html" class="sidebar-link">在 react-native 项目中使用 yarn link</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="搭建平台如何构建页面"><a href="#搭建平台如何构建页面" class="header-anchor">#</a> 搭建平台如何构建页面</h1> <p>这篇文章主要介绍了搭建平台的活动页构建过程，即点击了页面配置页右上角的「发布」按钮后是如何构建出可访问的活动页面的。由于搭建平台的项目比较复杂，本文只能做原理性的说明。
希望阅读本文前满足如下前提：</p> <ul><li>使用过搭建平台创建发布过活动页面</li> <li>开发过搭建平台组件（不必须）</li></ul> <h3 id="搭建平台的项目关系"><a href="#搭建平台的项目关系" class="header-anchor">#</a> 搭建平台的项目关系</h3> <p>从前端开发的角度，每个活动页都可以看做是一个单独的 React 应用，而组件都是一个 npm 包，在发布一个活动页面的过程就是在打包这个应用。不同的活动页就是不同的 React 应用，它们的组件配置及页面设置（分享、背景等）不同，除去这些不同的部分还有保持不变的部分，这就是 activity-maker-shell 这个项目的作用。activity-maker-shell 项目（后文简称 shell 项目）作为「壳应用」可视为活动页的一个框架。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>shell <span class="token operator">+</span> 组件配置 <span class="token operator">+</span> 页面配置 <span class="token operator">=</span> 活动页应用<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>和我们平时写的 React 应用一样，这里得到的活动页应用也是需要打包的。打包的过程是由 activity-maker-builder 项目（后文简称 builder 项目）来完成的，这是一个 node 服务，在获取到页面配置后会进行打包操作。</p> <p>活动页的构建使用了服务端渲染技术，需要先对此有个基础的了解。</p> <h3 id="服务端渲染-ssr-介绍"><a href="#服务端渲染-ssr-介绍" class="header-anchor">#</a> 服务端渲染（SSR）介绍</h3> <p>观察一下使用 create-react-app 创建的项目，其 html 结构是这样的，只有一个 root 节点。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">&gt;</span></span>You need to enable JavaScript to run this app.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果打开一个搭建平台的页面，查看获得的 html 文件，可以看到不单是一个 root 节点，而是一个完整的 html 结构。</p> <p><img src="http://fdfs.xmcdn.com/storages/daa8-audiofreehighqps/9D/8A/GKwRIJIIWFExAAFtagInSAmX.png" alt=""></p> <p>这里就是服务端渲染（SSR） 发挥了作用。</p> <p>明确一下概念，一般 SSR 的流程是：用户访问页面 -&gt; 服务端渲染生成完整的页面 -&gt; 用户获得页面文件，不同用户获得的页面可能是不同的。</p> <p>在搭建平台的流程中，点击「发布」按钮后就是在执行生成页面步骤，当用户访问一个页面时，它的文件已经在服务端准备好了。对应流程：服务端渲染生成页面文件 -&gt; 用户访问页面 -&gt; 用户获得页面文件，每个用户获得的 html 文件都是相同的。</p> <p>更精确地来说，搭建平台使用的技术应该被称为预渲染（prerender），不过涉及到 React 的实现方面两者很相似，所以本文后面的部分不会严格区分。</p> <h3 id="基础的-ssr-例子"><a href="#基础的-ssr-例子" class="header-anchor">#</a> 基础的 SSR 例子</h3> <p>假设我们想将一个普通的 React 单页面应用改造成 SSR 应用需要做哪些改造。这篇文章给出了一个例子：<a href="https://www.digitalocean.com/community/tutorials/react-server-side-rendering" target="_blank" rel="noopener noreferrer">How to Enable Server-Side Rendering for a React App<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>React 组件部分使用 <a href="https://react.dev/reference/react-dom/client/hydrateRoot" target="_blank" rel="noopener noreferrer">ReactDOM.hydrateRoot()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来代替 ReactDOM.render():</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom/client&quot;</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">hydrateRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>(在新版的 React 中，使用了 <a href="https://react.dev/reference/react-dom/client/hydrateRoot" target="_blank" rel="noopener noreferrer">ReactDOM.hydrateRoot()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 这个方法来代替)
使用 Express 实现的服务器端使用 <a href="https://react.dev/reference/react-dom/server/renderToString" target="_blank" rel="noopener noreferrer">ReactDOMServer.renderToString()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来获取 HTML 结构：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> ReactDOMServer <span class="token keyword">from</span> <span class="token string">&quot;react-dom/server&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// app: &lt;h1 data-reactroot=&quot;&quot;&gt;Hello &lt;!-- --&gt;Sammy&lt;!-- --&gt;!&lt;/h1&gt;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> ReactDOMServer<span class="token punctuation">.</span><span class="token function">renderToString</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 替换 html 文件中的空节点</span>
html<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div id=&quot;root&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>app<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="什么是-hydration"><a href="#什么是-hydration" class="header-anchor">#</a> 什么是 Hydration</h3> <p>SSR 中有一个 hydration 的概念，比如上面的 api 就是使用了 ReactDOM.hydrate() 的命名，需要说明下 hydration 指的是什么。</p> <p>使用 SSR，client side 在加载 script 之前得到了如下的 HTML 内容：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello Saeloun!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我们想要的是下图这样的，绿色的表示这部分页面可交互，比如所有的事件处理函数都挂载了（JS 完全加载）</p> <p><img src="http://fdfs.xmcdn.com/storages/dd71-audiofreehighqps/9D/6A/GMCoOSAIWFFHAAz5WQInSBJu.png" alt=""></p> <p>使用 CSR，当加载 JS 时，用户只能看到空白页面：</p> <p>对于 SSR，用户提前得到了完整的 HTML，在 JS 还在加载时就能看到东西。但是页面并不能完全交互，比如点击按钮无效。</p> <p><img src="http://fdfs.xmcdn.com/storages/798f-audiofreehighqps/06/7C/GMCoOScIWFFbAAoE2gInSBq6.png" alt=""></p> <p>Hydration 就是在 client 端将 JavaScript 逻辑和在 server 端生成的 HTML 联系起来。
React 会在内存中 render 组件树，但不会为它生成 DOM 节点，而是将逻辑 attach 到已有的 HTML 上。</p> <blockquote><p>We tell React to attach event handlers to the HTML to make the app interactive. This process of rendering our components and attaching event handlers is known as “hydration”. It is like watering the ‘dry’ HTML with the ‘water’ of interactivity and event handlers. After hydration, our application becomes interactive, responding to clicks, and so on.</p></blockquote> <p><a href="https://blog.saeloun.com/2021/12/16/hydration/" target="_blank" rel="noopener noreferrer">Understanding Hydration in React applications(SSR)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="简化的项目"><a href="#简化的项目" class="header-anchor">#</a> 简化的项目</h3> <p>我写了一个简化的项目 <a href="https://github.com/18355166248/xm-build-platform/tree/main/render-test" target="_blank" rel="noopener noreferrer">render-test<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，仅做说明页面构建原理之用。这个简化项目中的代码和 shell 及 builder 项目并不完全一致，但尽量保证了函数名相关，通过搜索对应的函数名可以找到原项目中的相关代码。</p> <h4 id="项目功能及结构"><a href="#项目功能及结构" class="header-anchor">#</a> 项目功能及结构</h4> <p>项目中主要分为 client 和 server 两部分：</p> <ul><li>client - 对应于 shell 项目，包括 React 应用相关内容</li> <li>server - 对应于 builder 项目，包括打包页面的部分</li></ul> <p>server/activity.json 是一个页面配置文件，其中配置了文本组件、图片容器、倒计时组件，运行 npm run start:clean 将会依据这个配置构建页面，打开对应端口可查看。</p> <h5 id="组件配置解析"><a href="#组件配置解析" class="header-anchor">#</a> 组件配置解析</h5> <p>首先看下配置页面保存的数据结构是什么样的，以下来自点击「保存」按钮后调用的接口数据：</p> <p><img src="http://fdfs.xmcdn.com/storages/d6e9-audiofreehighqps/99/A5/GKwRIUEIWFFuAALVoQInSCFx.png" alt=""></p> <p>config 字段是一个 json 的字符串，parse 之后得到的结构如下，包括按组件类型区分的组件配置数据及页面配置数据。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token punctuation">{</span>
   staticElements<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   fixedElements<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   modalElements<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   nestedElements<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   global<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>项目中将 config 数据保存 server/activity.json 中，接下来就是如何依据这个 json 文件打包页面。</p> <p>对于 shell 项目来说，它会提前被打包成一个 npm 包，即 @xmly/activity-maker-shell ，在打包 shell 项目的时候它并不知道页面上会用到哪些组件，它会如何渲染？</p> <p>解决方案是页面构建时读取页面配置，生成一个记录了页面用到的组件的文件。</p> <p>以本简化项目为例，client 中的部分会打包至 dist/shell.js 文件中，server 在解析了页面配置后，在 dist/module.js 中写入如下内容：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// module.js</span>
<span class="token keyword">const</span> TextBox_1_2_2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@xmc/text-box-1.2.2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>
<span class="token keyword">const</span> ImageContainer_3_1_3 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@xmc/image-container-3.1.3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>
<span class="token keyword">const</span> Countdown_1_1_7 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@xmc/countdown-1.1.7&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>

<span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;@xmc/text-box@1.2.2&quot;</span><span class="token operator">:</span> TextBox_1_2_2<span class="token punctuation">,</span>
  <span class="token string-property property">&quot;@xmc/image-container@3.1.3&quot;</span><span class="token operator">:</span> ImageContainer_3_1_3<span class="token punctuation">,</span>
  <span class="token string-property property">&quot;@xmc/countdown@1.1.7&quot;</span><span class="token operator">:</span> Countdown_1_1_7<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> modules<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>因为这个文件是动态生成的，构建不同的页面都会生成对应的文件，自然就知道了页面上使用了哪些组件。module.js 文件会在 client/repo.js 中使用，文件内容如下，其中的 initializeRepo() 会引入 module.js：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Repository</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>modules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>modules<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> module<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modules<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> repo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Repository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initializeRepo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./module&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    repo<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> modules<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>调用 initializeRepo() 初始化完成后，从 repo.modules 中就可以找到需要的组件了。在 App 组件中这样使用导出的 repo：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// client/App.jsx</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> repo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./repo&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> config <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>config<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> Component <span class="token operator">=</span> repo<span class="token punctuation">.</span>modules<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>Component
            id<span class="token operator">=</span><span class="token punctuation">{</span>element<span class="token punctuation">.</span>id<span class="token punctuation">}</span>
            alias<span class="token operator">=</span><span class="token punctuation">{</span>element<span class="token punctuation">.</span>alias<span class="token punctuation">}</span>
            forms<span class="token operator">=</span><span class="token punctuation">{</span>element<span class="token punctuation">.</span>forms<span class="token punctuation">}</span>
          <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
           
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>上述流程如下：</p> <p><img src="http://fdfs.xmcdn.com/storages/050e-audiofreehighqps/A5/09/GMCoOSIIWFGpAAA5BAInSDOR.png" alt=""></p> <h3 id="执行构建"><a href="#执行构建" class="header-anchor">#</a> 执行构建</h3> <p>现在我们知道了页面上用到的组件，到了打包构建的步骤。从 HTML 模板文件 public/index.html 看起，其内容如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    **STYLE_TAGS**

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
     <span class="token keyword">try</span> <span class="token punctuation">{</span>
       window<span class="token punctuation">.</span>serverData <span class="token operator">=</span> <span class="token operator">**</span><span class="token constant">SERVER_DATA</span><span class="token operator">**</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./bundle.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>其中留下了几个标志位：</p> <ul><li>__SERVER_DATA__ - 页面配置数据，对应 hydration 过程</li> <li>__STYLE_TAGS__ - 样式内容</li> <li><div id="root"></div> - HTML 结构
</li></ul> <p>构建过程中会生成 bundle.js 文件，并用页面的真实数据来替换上述位置。</p> <p>运行 npm run build:client 会将 client 目录打包，生成 dist/shell.js 文件，提供 renderAppToHTML 方法。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">renderAppToHtml</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> htmlTemplate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> styleTags <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">renderAppToString</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> lastHtml <span class="token operator">=</span> htmlTemplate
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div id=&quot;root&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>app<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;**SERVER_DATA**&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;**STYLE_TAGS**&quot;</span><span class="token punctuation">,</span> styleTags<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> lastHtml<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>可以看到这个方法做的事情就是在对模板文件做了替换，后面会对此详细解释。</p> <h4 id="js-的编译"><a href="#js-的编译" class="header-anchor">#</a> js 的编译</h4> <p>首先从熟悉的 js 打包过程开始了解构建过程，在这个简化项目中只是建立了一个基础的 webpack 配置。之前的步骤中已生成 dist/shell.js 文件，然后以此为 webpack 打包入口，生成的文件位于 dist/bundle.js 中。</p> <h4 id="serverdata-注入"><a href="#serverdata-注入" class="header-anchor">#</a> serverData 注入</h4> <p>随便打开一个活动页面，在控制台中可以查看 window.serverData 变量的值，其中保存了活动页所有相关的配置：</p> <p><img src="http://fdfs.xmcdn.com/storages/5c18-audiofreehighqps/8B/5B/GKwRIRwIWFHCAAEFEgInSEAe.png" alt=""></p> <p>它在 html 模板文件中对应于：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>serverData <span class="token operator">=</span> __SERVER_DATA__<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>需要将其中的 __SERVER_DATA__ 替换成页面配置的 json 字符串：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>htmlTemplate<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;__SERVER_DATA__&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样就得到了一个普通的 inline script，运行后就注入了 window.serverData 这个变量。</p> <p><img src="http://fdfs.xmcdn.com/storages/2fac-audiofreehighqps/09/86/GKwRIW4IWFHRAADuSgInSEcX.png" alt=""></p> <p>而 React 应用在 hydration 这一步的时候就会取出这里的数据作为 props 传入：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> hydrateRoot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-dom/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">hydrateRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token operator">&lt;</span>App config<span class="token operator">=</span><span class="token punctuation">{</span>window<span class="token punctuation">.</span>serverData<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="样式提取"><a href="#样式提取" class="header-anchor">#</a> 样式提取</h4> <p>如果你开发过搭建平台的组件，会注意到所有的组件样式都是用 styled-components 来处理，在 SSR 的过程中可以利用 styled-components 提供的 API 将所有组件的样式统一提取出来：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> renderToString <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-dom/server&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ServerStyleSheet <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;styled-components&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> sheet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerStyleSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">renderToString</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span><span class="token function">collectStyles</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>YourApp <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> styleTags <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getStyleTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// or sheet.getStyleElement();</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上述代码修改自 <a href="https://styled-components.com/docs/advanced#server-side-rendering" target="_blank" rel="noopener noreferrer">styled-components 的 Server Side Rendering<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 文档。</p> <p>这里得到的 styleTags 就是提取自应用/组件中的样式，用其替换 html 模板中的 __STYLE_TAGS__。</p> <h4 id="替换-root-节点"><a href="#替换-root-节点" class="header-anchor">#</a> 替换 root 节点</h4> <p>然后就是将 </p><div id="root"></div> 替换成完整的 html 结构：<p></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">renderAppToString</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> styleTags <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> sheet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerStyleSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app <span class="token operator">=</span> ReactDOMServer<span class="token punctuation">.</span><span class="token function">renderToString</span><span class="token punctuation">(</span>
    sheet<span class="token punctuation">.</span><span class="token function">collectStyles</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App config<span class="token operator">=</span><span class="token punctuation">{</span>config<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  styleTags <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getStyleTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> styleTags <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在这里得到了 app 和 styleTags 两个字符串，app 是组件对应的页面结构，styleTags 是提取出来的样式内容，分别替换：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>htmlTemplate
  <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div id=&quot;root&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>app<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;**STYLE_TAGS**&quot;</span><span class="token punctuation">,</span> styleTags<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>至此，一个简化的构建流程就完成了。</p> <h2 id="线上项目说明"><a href="#线上项目说明" class="header-anchor">#</a> 线上项目说明</h2> <p>在这个简化项目中，省略了很多步骤。比如构建过程中 js 文件是会上传至 CDN 的，还有使用了 redis 来作为 html 文件的缓存。这些可以从 builder 项目代码 activity-maker-builder/src/service/builder.ts 看起。</p> <p>在简化项目中当前仅处理了 static 类型的组件，nested 类型的组件比如热区暂不支持。热区主要是通过组件的递归渲染来实现的，具体可看 activity-maker-shell/src/components/recursive.tsx 的组件实现。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/26/2023, 4:22:22 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/Transshipment/FrontEnd/" class="prev router-link-active">
        转载
      </a></span> <span class="next"><a href="/notes/Transshipment/FrontEnd/ReactNative/yarn-link.html">
        在 react-native 项目中使用 yarn link
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.73a5ecf6.js" defer></script><script src="/assets/js/2.590ae2eb.js" defer></script><script src="/assets/js/1.bccb620a.js" defer></script><script src="/assets/js/487.dede7361.js" defer></script>
  </body>
</html>
