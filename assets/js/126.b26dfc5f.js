(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{510:function(n,e,s){"use strict";s.r(e);var t=s(45),a=Object(t.a)({},(function(){var n=this,e=n.$createElement,s=n._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h1",{attrs:{id:"events模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#events模块"}},[n._v("#")]),n._v(" Events模块")]),n._v(" "),s("p",[n._v("const fn1 = (... args)=>console.log('I want sleep1', ... args)\nconst fn2 = (... args)=>console.log('I want sleep2', ... args)")]),n._v(" "),s("p",[n._v("function Events () {\nthis.tasks = []\nthis.onceTasks = []\n}")]),n._v(" "),s("p",[n._v("Events.prototype = {\non: function () {\nconst eventName = arguments[0]\nconst fn = arguments[1]\nconst params = [...arguments].slice(2)")]),n._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[n._v("if (eventName === 'sleep') {\n  this.tasks.push({fn, params})\n}\n")])])]),s("p",[n._v("},\nfire: function () {\nconst eventName = arguments[0]\nconst params = [...arguments].slice(1)")]),n._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[n._v("if (eventName === 'sleep') {\n  this.tasks.forEach((task, index) => {\n    task.fn([...task.params, ...params].join(' '))\n\n    if (index === this.tasks.length - 1 && this.onceTasks.length > 0) {\n      this.onceTasks.forEach(onceTask => onceTask.fn())\n\n      this.onceTasks = []\n    }\n  })\n}\n")])])]),s("p",[n._v("},\noff: function () {\nconst eventName = arguments[0]")]),n._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[n._v("if (eventName === 'sleep') {\n  const fn = arguments[1]\n  const index = this.tasks.findIndex(task => task.fn === fn)\n  if (index > -1) this.tasks.splice(index, 1)\n}\n")])])]),s("p",[n._v("},\nonce: function () {\nconst eventName = arguments[0]\nif (eventName === 'sleep') {\nthis.onceTasks.push({fn: arguments[1]})\n}\n}\n}")]),n._v(" "),s("p",[n._v("const event = new Events();")]),n._v(" "),s("p",[n._v("event.on('sleep', fn1, 1, 2, 3);\nevent.on('sleep', fn2, 1, 2, 3);\nevent.fire('sleep', 4, 5, 6);\nevent.off('sleep', fn1);\nevent.once('sleep', () => console.log('I want sleep'));\nevent.fire('sleep');\nevent.fire('sleep');")])])}),[],!1,null,null,null);e.default=a.exports}}]);